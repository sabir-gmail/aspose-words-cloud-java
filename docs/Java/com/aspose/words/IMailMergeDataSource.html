<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"
><HTML>
<HEAD>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<!-- Generated by javadoc - compatibility string-->
<!-- Generated by Aspose.JavaDoc 09 Aug 2018 -->
<TITLE>IMailMergeDataSource</TITLE>
<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../stylesheet.css" TITLE="Style"></HEAD>
<BODY BGCOLOR="white">
<!-- ======== START OF CLASS DATA ======== -->
<H2><a href="package-summary.html"><FONT SIZE="-1">
com.aspose.words
</FONT></a><BR>Interface IMailMergeDataSource</H2>
<HR>
<DL>
<DT><PRE>public interface <B>IMailMergeDataSource </B></DL>
</PRE>

<P>

<summary>
            Implement this interface to allow mail merge from a custom data source, such as a list of objects. Master-detail data is also supported.
            </summary><remarks><p>When a data source is created, it should be initialized to point to BOF (before the first record).
            The Aspose.Words mail merge engine will invoke <cref><A HREF="#moveNext()" title="method in class com.aspose.words.IMailMergeDataSource">moveNext()</A></cref> to advance to next record and 
            then invoke <cref><B>#Error Cref:</B> <I>M:Aspose.Words.MailMerging.IMailMergeDataSource.GetValue(System.String,System.Object@)</I></cref> for every merge field it encounters in the document or the current mail merge region.</p></remarks><example><p><b>Example:</b></p>Performs mail merge from a custom data source.<pre>
public void mailMergeCustomDataSource() throws Exception
{
    // Create some data that we will use in the mail merge.
    CustomerList customers = new CustomerList();
    customers.add(new Customer("Thomas Hardy", "120 Hanover Sq., London"));
    customers.add(new Customer("Paolo Accorti", "Via Monte Bianco 34, Torino"));

    // Open the template document.
    Document doc = new Document(getMyDir() + "MailMerge.CustomDataSource.doc");

    // To be able to mail merge from your own data source, it must be wrapped
    // into an object that implements the IMailMergeDataSource interface.
    CustomerMailMergeDataSource customersDataSource = new CustomerMailMergeDataSource(customers);

    // Now you can pass your data source into Aspose.Words.
    doc.getMailMerge().execute(customersDataSource);

    doc.save(getMyDir() + "\\Artifacts\\MailMerge.CustomDataSource.doc");
}

/**
 * An example of a "data entity" class in your application.
 */
public class Customer
{
    public Customer(String aFullName, String anAddress)
    {
        mFullName = aFullName;
        mAddress = anAddress;
    }

    public String getFullName()
    {
        return mFullName;
    }

    public void setFullName(String value)
    {
        mFullName = value;
    }

    public String getAddress()
    {
        return mAddress;
    }

    public void setAddress(String value)
    {
        mAddress = value;
    }

    private String mFullName;
    private String mAddress;
}

/**
 * An example of a typed collection that contains your "data" objects.
 */
public class CustomerList extends ArrayList
{
    public Customer get(int index)
    {
        return (Customer) super.get(index);
    }

    public void set(int index, Customer value)
    {
        super.set(index, value);
    }
}

/**
 * A custom mail merge data source that you implement to allow Aspose.Words
 * to mail merge data from your Customer objects into Microsoft Word documents.
 */
public class CustomerMailMergeDataSource implements IMailMergeDataSource
{
    public CustomerMailMergeDataSource(CustomerList customers)
    {
        mCustomers = customers;

        // When the data source is initialized, it must be positioned before the first record.
        mRecordIndex = -1;
    }

    /**
     * The name of the data source. Used by Aspose.Words only when executing mail merge with repeatable regions.
     */
    public String getTableName()
    {
        return "Customer";
    }

    /**
     * Aspose.Words calls this method to get a value for every data field.
     */
    public boolean getValue(String fieldName, Ref&lt;Object&gt; fieldValue) throws Exception
    {
        if (fieldName.equals("FullName"))
        {
            fieldValue.set(mCustomers.get(mRecordIndex).getFullName());
            return true;
        } else if (fieldName.equals("Address"))
        {
            fieldValue.set(mCustomers.get(mRecordIndex).getAddress());
            return true;
        } else
        {
            // A field with this name was not found,
            // return false to the Aspose.Words mail merge engine.
            fieldValue.set(null);
            return false;
        }
    }

    /**
     * A standard implementation for moving to a next record in a collection.
     */
    public boolean moveNext() throws Exception
    {
        if (!isEof()) mRecordIndex++;

        return (!isEof());
    }

    public IMailMergeDataSource getChildDataSource(String tableName)
    {
        return null;
    }

    private boolean isEof()
    {
        return (mRecordIndex &gt;= mCustomers.size());
    }

    private final CustomerList mCustomers;
    private int mRecordIndex;
}</pre></example><DL><DT><B>See Also:</B></DT><DD><cref seealso=""><A HREF="MailMerge.html" title="class in com.aspose.words">MailMerge</A></cref></DD></DL>
<HR>
<P>

<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<P>

<!-- ========== PROPERTY SUMMARY =========== -->

<A NAME="property_summary"><!-- --></A>
<TABLE RULES="GROUPS" BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<COLGROUP></COLGROUP><COLGROUP SPAN="2"></COLGROUP><THEAD><TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="3"><FONT SIZE="+2">
<B>Property Getters/Setters Summary</B></FONT></TH>
</TR></THEAD>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE>abstract&nbsp;java.lang.String</CODE></TD><TD><CODE><B><A HREF="#TableName">getTableName</A></B>()</CODE></TD><TD ALIGN="right" ></TD></TR><TR><TD></TD><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
             Returns the name of the data source.
             </TD>
</TR></TBODY>
</TABLE>&nbsp;

<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" RULES="GROUPS" FRAME="BOX" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<COLGROUP></COLGROUP><COLGROUP SPAN="2"></COLGROUP><THEAD><TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="3"><FONT SIZE="+2">
<B>Method Summary</B></FONT></TH>
</TR></THEAD>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ROWSPAN="2" ALIGN="right" VALIGN="top" WIDTH="1%">
<CODE>abstract&nbsp;<A HREF="IMailMergeDataSource.html" title="interface in com.aspose.words">IMailMergeDataSource</A></CODE></TD><TD><CODE><B><A HREF="#getChildDataSource(java.lang.String)">getChildDataSource</A></B>(java.lang.String&nbsp;tableName)</CODE></TD><TD ALIGN="right" ></TD>
</TR><TR><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            The Aspose.Words mail merge engine invokes this method when it encounters a beginning of a nested mail merge region.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ROWSPAN="2" ALIGN="right" VALIGN="top" WIDTH="1%">
<CODE>abstract&nbsp;boolean</CODE></TD><TD><CODE><B><A HREF="#moveNext()">moveNext</A></B>()</CODE></TD><TD ALIGN="right" ></TD>
</TR><TR><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Advances to the next record in the data source.
            </TD>
</TR></TBODY>
</TABLE>&nbsp;<P>

<!-- ============ PROPERTY DETAIL ========== -->

<A NAME="property_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Property Getters/Setters Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="TableName"><!-- --></A><A NAME="getTableName()"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>getTableName</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public abstract&nbsp;java.lang.String&nbsp;<B>getTableName</B>()
</PRE></TD></TR></TABLE>
<DL><DD><summary>
             Returns the name of the data source.
             </summary><remarks><p>If you are implementing <cref><i>IMailMergeDataSource</i></cref>, return the name of the data
             source from this property.</p><p>Aspose.Words uses this name to match against the mail merge region name specified
             in the template document. The comparison between the data source name and
             the mail merge region name is not case sensitive.</p></remarks><example><p><b>Example:</b></p>Performs mail merge from a custom data source.<pre>
public void mailMergeCustomDataSource() throws Exception
{
    // Create some data that we will use in the mail merge.
    CustomerList customers = new CustomerList();
    customers.add(new Customer("Thomas Hardy", "120 Hanover Sq., London"));
    customers.add(new Customer("Paolo Accorti", "Via Monte Bianco 34, Torino"));

    // Open the template document.
    Document doc = new Document(getMyDir() + "MailMerge.CustomDataSource.doc");

    // To be able to mail merge from your own data source, it must be wrapped
    // into an object that implements the IMailMergeDataSource interface.
    CustomerMailMergeDataSource customersDataSource = new CustomerMailMergeDataSource(customers);

    // Now you can pass your data source into Aspose.Words.
    doc.getMailMerge().execute(customersDataSource);

    doc.save(getMyDir() + "\\Artifacts\\MailMerge.CustomDataSource.doc");
}

/**
 * An example of a "data entity" class in your application.
 */
public class Customer
{
    public Customer(String aFullName, String anAddress)
    {
        mFullName = aFullName;
        mAddress = anAddress;
    }

    public String getFullName()
    {
        return mFullName;
    }

    public void setFullName(String value)
    {
        mFullName = value;
    }

    public String getAddress()
    {
        return mAddress;
    }

    public void setAddress(String value)
    {
        mAddress = value;
    }

    private String mFullName;
    private String mAddress;
}

/**
 * An example of a typed collection that contains your "data" objects.
 */
public class CustomerList extends ArrayList
{
    public Customer get(int index)
    {
        return (Customer) super.get(index);
    }

    public void set(int index, Customer value)
    {
        super.set(index, value);
    }
}

/**
 * A custom mail merge data source that you implement to allow Aspose.Words
 * to mail merge data from your Customer objects into Microsoft Word documents.
 */
public class CustomerMailMergeDataSource implements IMailMergeDataSource
{
    public CustomerMailMergeDataSource(CustomerList customers)
    {
        mCustomers = customers;

        // When the data source is initialized, it must be positioned before the first record.
        mRecordIndex = -1;
    }

    /**
     * The name of the data source. Used by Aspose.Words only when executing mail merge with repeatable regions.
     */
    public String getTableName()
    {
        return "Customer";
    }

    /**
     * Aspose.Words calls this method to get a value for every data field.
     */
    public boolean getValue(String fieldName, Ref&lt;Object&gt; fieldValue) throws Exception
    {
        if (fieldName.equals("FullName"))
        {
            fieldValue.set(mCustomers.get(mRecordIndex).getFullName());
            return true;
        } else if (fieldName.equals("Address"))
        {
            fieldValue.set(mCustomers.get(mRecordIndex).getAddress());
            return true;
        } else
        {
            // A field with this name was not found,
            // return false to the Aspose.Words mail merge engine.
            fieldValue.set(null);
            return false;
        }
    }

    /**
     * A standard implementation for moving to a next record in a collection.
     */
    public boolean moveNext() throws Exception
    {
        if (!isEof()) mRecordIndex++;

        return (!isEof());
    }

    public IMailMergeDataSource getChildDataSource(String tableName)
    {
        return null;
    }

    private boolean isEof()
    {
        return (mRecordIndex &gt;= mCustomers.size());
    }

    private final CustomerList mCustomers;
    private int mRecordIndex;
}</pre></example><DL><DT><B>Returns:</B></DT><DD returns="">The name of the data source. Empty string if the data source has no name.</DD></DL>
</DL>
<HR>



<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Method Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="getChildDataSource(java.lang.String)"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>getChildDataSource</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public abstract&nbsp;<A HREF="IMailMergeDataSource.html" title="interface in com.aspose.words">IMailMergeDataSource</A>&nbsp;<B>getChildDataSource</B>(java.lang.String&nbsp;tableName)
                                                     throws java.lang.Exception</PRE></TD></TR></TABLE>
<DL><DD><summary>
            The Aspose.Words mail merge engine invokes this method when it encounters a beginning of a nested mail merge region.
            </summary><remarks><p>
            When the Aspose.Words mail merge engines populates a mail merge region with data and encounters the beginning of a nested
            mail merge region in the form of MERGEFIELD TableStart:TableName, it invokes <cref><i>getChildDataSource(java.lang.String)</i></cref> on the current 
            data source object. Your implementation needs to return a new data source object that will provide access to the child 
            records of the current parent record. Aspose.Words will use the returned data source to populate the nested mail merge region.
            </p><p>
            Below are the rules that the implementation of <cref><i>getChildDataSource(java.lang.String)</i></cref> must follow.
            </p><p>
            If the table that is represented by this data source object has a related child (detail) table with the specified name,
            then your implementation needs to return a new <cref><i>IMailMergeDataSource</i></cref> object that will provide access
            to the child records of the current record.
            
            An example of this is Orders / OrderDetails relationship. Let's assume that the current <cref><i>IMailMergeDataSource</i></cref> object
            represents the Orders table and it has a current order record. Next, Aspose.Words encounters "MERGEFIELD TableStart:OrderDetails" 
            in the document and invokes <cref><i>getChildDataSource(java.lang.String)</i></cref>. You need to create and return a <cref><i>IMailMergeDataSource</i></cref> 
            object that will allow Aspose.Words to access the OrderDetails record for the current order.
            </p><p>
            If this data source object does not have a relation to the table with the specified name, then you need to return 
            a <cref><i>IMailMergeDataSource</i></cref> object that will provide access to all records of the specified table.
            </p><p>
            If a table with the specified name does not exist, your implementation should return <code>null</code>.
            </p></remarks><DL><DT><B>Parameters:</B></DT><DD param="tableName"><CODE>tableName</CODE> - The name of the mail merge region as specified in the template document. Case-insensitive.</DD></DL><DL><DT><B>Returns:</B></DT><DD returns="">A data source object that will provide access to the data records of the specified table.</DD></DL><example><p><b>Example:</b></p>Performs mail merge from a custom data source.<pre>
public void mailMergeCustomDataSource() throws Exception
{
    // Create some data that we will use in the mail merge.
    CustomerList customers = new CustomerList();
    customers.add(new Customer("Thomas Hardy", "120 Hanover Sq., London"));
    customers.add(new Customer("Paolo Accorti", "Via Monte Bianco 34, Torino"));

    // Open the template document.
    Document doc = new Document(getMyDir() + "MailMerge.CustomDataSource.doc");

    // To be able to mail merge from your own data source, it must be wrapped
    // into an object that implements the IMailMergeDataSource interface.
    CustomerMailMergeDataSource customersDataSource = new CustomerMailMergeDataSource(customers);

    // Now you can pass your data source into Aspose.Words.
    doc.getMailMerge().execute(customersDataSource);

    doc.save(getMyDir() + "\\Artifacts\\MailMerge.CustomDataSource.doc");
}

/**
 * An example of a "data entity" class in your application.
 */
public class Customer
{
    public Customer(String aFullName, String anAddress)
    {
        mFullName = aFullName;
        mAddress = anAddress;
    }

    public String getFullName()
    {
        return mFullName;
    }

    public void setFullName(String value)
    {
        mFullName = value;
    }

    public String getAddress()
    {
        return mAddress;
    }

    public void setAddress(String value)
    {
        mAddress = value;
    }

    private String mFullName;
    private String mAddress;
}

/**
 * An example of a typed collection that contains your "data" objects.
 */
public class CustomerList extends ArrayList
{
    public Customer get(int index)
    {
        return (Customer) super.get(index);
    }

    public void set(int index, Customer value)
    {
        super.set(index, value);
    }
}

/**
 * A custom mail merge data source that you implement to allow Aspose.Words
 * to mail merge data from your Customer objects into Microsoft Word documents.
 */
public class CustomerMailMergeDataSource implements IMailMergeDataSource
{
    public CustomerMailMergeDataSource(CustomerList customers)
    {
        mCustomers = customers;

        // When the data source is initialized, it must be positioned before the first record.
        mRecordIndex = -1;
    }

    /**
     * The name of the data source. Used by Aspose.Words only when executing mail merge with repeatable regions.
     */
    public String getTableName()
    {
        return "Customer";
    }

    /**
     * Aspose.Words calls this method to get a value for every data field.
     */
    public boolean getValue(String fieldName, Ref&lt;Object&gt; fieldValue) throws Exception
    {
        if (fieldName.equals("FullName"))
        {
            fieldValue.set(mCustomers.get(mRecordIndex).getFullName());
            return true;
        } else if (fieldName.equals("Address"))
        {
            fieldValue.set(mCustomers.get(mRecordIndex).getAddress());
            return true;
        } else
        {
            // A field with this name was not found,
            // return false to the Aspose.Words mail merge engine.
            fieldValue.set(null);
            return false;
        }
    }

    /**
     * A standard implementation for moving to a next record in a collection.
     */
    public boolean moveNext() throws Exception
    {
        if (!isEof()) mRecordIndex++;

        return (!isEof());
    }

    public IMailMergeDataSource getChildDataSource(String tableName)
    {
        return null;
    }

    private boolean isEof()
    {
        return (mRecordIndex &gt;= mCustomers.size());
    }

    private final CustomerList mCustomers;
    private int mRecordIndex;
}</pre></example>
</DL>
<HR>

<A NAME="moveNext()"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>moveNext</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public abstract&nbsp;boolean&nbsp;<B>moveNext</B>()
                              throws java.lang.Exception</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Advances to the next record in the data source.
            </summary><DL><DT><B>Returns:</B></DT><DD returns="">True if moved to next record successfully. False if reached end of the data source.</DD></DL><example><p><b>Example:</b></p>Performs mail merge from a custom data source.<pre>
public void mailMergeCustomDataSource() throws Exception
{
    // Create some data that we will use in the mail merge.
    CustomerList customers = new CustomerList();
    customers.add(new Customer("Thomas Hardy", "120 Hanover Sq., London"));
    customers.add(new Customer("Paolo Accorti", "Via Monte Bianco 34, Torino"));

    // Open the template document.
    Document doc = new Document(getMyDir() + "MailMerge.CustomDataSource.doc");

    // To be able to mail merge from your own data source, it must be wrapped
    // into an object that implements the IMailMergeDataSource interface.
    CustomerMailMergeDataSource customersDataSource = new CustomerMailMergeDataSource(customers);

    // Now you can pass your data source into Aspose.Words.
    doc.getMailMerge().execute(customersDataSource);

    doc.save(getMyDir() + "\\Artifacts\\MailMerge.CustomDataSource.doc");
}

/**
 * An example of a "data entity" class in your application.
 */
public class Customer
{
    public Customer(String aFullName, String anAddress)
    {
        mFullName = aFullName;
        mAddress = anAddress;
    }

    public String getFullName()
    {
        return mFullName;
    }

    public void setFullName(String value)
    {
        mFullName = value;
    }

    public String getAddress()
    {
        return mAddress;
    }

    public void setAddress(String value)
    {
        mAddress = value;
    }

    private String mFullName;
    private String mAddress;
}

/**
 * An example of a typed collection that contains your "data" objects.
 */
public class CustomerList extends ArrayList
{
    public Customer get(int index)
    {
        return (Customer) super.get(index);
    }

    public void set(int index, Customer value)
    {
        super.set(index, value);
    }
}

/**
 * A custom mail merge data source that you implement to allow Aspose.Words
 * to mail merge data from your Customer objects into Microsoft Word documents.
 */
public class CustomerMailMergeDataSource implements IMailMergeDataSource
{
    public CustomerMailMergeDataSource(CustomerList customers)
    {
        mCustomers = customers;

        // When the data source is initialized, it must be positioned before the first record.
        mRecordIndex = -1;
    }

    /**
     * The name of the data source. Used by Aspose.Words only when executing mail merge with repeatable regions.
     */
    public String getTableName()
    {
        return "Customer";
    }

    /**
     * Aspose.Words calls this method to get a value for every data field.
     */
    public boolean getValue(String fieldName, Ref&lt;Object&gt; fieldValue) throws Exception
    {
        if (fieldName.equals("FullName"))
        {
            fieldValue.set(mCustomers.get(mRecordIndex).getFullName());
            return true;
        } else if (fieldName.equals("Address"))
        {
            fieldValue.set(mCustomers.get(mRecordIndex).getAddress());
            return true;
        } else
        {
            // A field with this name was not found,
            // return false to the Aspose.Words mail merge engine.
            fieldValue.set(null);
            return false;
        }
    }

    /**
     * A standard implementation for moving to a next record in a collection.
     */
    public boolean moveNext() throws Exception
    {
        if (!isEof()) mRecordIndex++;

        return (!isEof());
    }

    public IMailMergeDataSource getChildDataSource(String tableName)
    {
        return null;
    }

    private boolean isEof()
    {
        return (mRecordIndex &gt;= mCustomers.size());
    }

    private final CustomerList mCustomers;
    private int mRecordIndex;
}</pre></example>
</DL>
<HR>

<B>See Also:</B>
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A href="http://www.aspose.com/Products/Aspose.Words/Api/index.html" TARGET="_blank">Aspose.Words Documentation</A> - the home page for the Aspose.Words Product Documentation.<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A href="http://www.aspose.com/Community/forums/ShowForum.aspx?ForumID=75" TARGET="_blank">Aspose.Words Support Forum</A> - our preferred method of support.<P>
<div class="footer"><hr><p><a href='http://www.aspose.com/Wiki/default.aspx/Aspose.Corporate/ContactAspose.html'>We guarantee a prompt response to any inquiry!</a></p><p>&copy; 2003-2007 Aspose Pty Ltd. All rights reserved.</p></div></BODY></HTML>