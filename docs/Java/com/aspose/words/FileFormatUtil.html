<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"
><HTML>
<HEAD>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<!-- Generated by javadoc - compatibility string-->
<!-- Generated by Aspose.JavaDoc 09 Aug 2018 -->
<TITLE>FileFormatUtil</TITLE>
<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../stylesheet.css" TITLE="Style"></HEAD>
<BODY BGCOLOR="white">
<!-- ======== START OF CLASS DATA ======== -->
<H2><a href="package-summary.html"><FONT SIZE="-1">
com.aspose.words
</FONT></a><BR>Class FileFormatUtil</H2>
<PRE>
java.lang.Object
    <IMG SRC="../../../resources/inherit.gif" ALT="extended by "><B>com.aspose.words.FileFormatUtil</B>
</PRE>
<HR>
<DL>
<DT><PRE>public abstract class <B>FileFormatUtil </B><DT>extends java.lang.Object</DL>
</PRE>

<P>

<summary>
            Provides utility methods for working with file formats, such as detecting file format 
            or converting file extensions to/from file format enums.
            </summary><example><p><b>Example:</b></p>Check each file in the folder and move it to the appropriate subfolder.<pre>
// Loop through all found files.
for (File file : fileList)
{
    if (file.isDirectory())
        continue;

    // Extract and display the file name without the path.
    String nameOnly = file.getName();
    System.out.print(nameOnly);

    // Check the file format and move the file to the appropriate folder.
    String fileName = file.getPath();
    FileFormatInfo info = FileFormatUtil.detectFileFormat(fileName);

    // Display the document type.
    switch (info.getLoadFormat())
    {
        case LoadFormat.DOC:
            System.out.println("\tMicrosoft Word 97-2003 document.");
            break;
        case LoadFormat.DOT:
            System.out.println("\tMicrosoft Word 97-2003 template.");
            break;
        case LoadFormat.DOCX:
            System.out.println("\tOffice Open XML WordprocessingML Macro-Free Document.");
            break;
        case LoadFormat.DOCM:
            System.out.println("\tOffice Open XML WordprocessingML Macro-Enabled Document.");
            break;
        case LoadFormat.DOTX:
            System.out.println("\tOffice Open XML WordprocessingML Macro-Free Template.");
            break;
        case LoadFormat.DOTM:
            System.out.println("\tOffice Open XML WordprocessingML Macro-Enabled Template.");
            break;
        case LoadFormat.FLAT_OPC:
            System.out.println("\tFlat OPC document.");
            break;
        case LoadFormat.RTF:
            System.out.println("\tRTF format.");
            break;
        case LoadFormat.WORD_ML:
            System.out.println("\tMicrosoft Word 2003 WordprocessingML format.");
            break;
        case LoadFormat.HTML:
            System.out.println("\tHTML format.");
            break;
        case LoadFormat.MHTML:
            System.out.println("\tMHTML (Web archive) format.");
            break;
        case LoadFormat.ODT:
            System.out.println("\tOpenDocument Text.");
            break;
        case LoadFormat.OTT:
            System.out.println("\tOpenDocument Text Template.");
            break;
        case LoadFormat.DOC_PRE_WORD_60:
            System.out.println("\tMS Word 6 or Word 95 format.");
            break;
        case LoadFormat.UNKNOWN:
        default:
            System.out.println("\tUnknown format.");
            break;
    }

    // Now copy the document into the appropriate folder.
    if (info.isEncrypted())
    {
        System.out.println("\tAn encrypted document.");
        fileCopy(fileName, new File(encryptedDir, nameOnly).getPath());
    }
    else
    {
        switch (info.getLoadFormat())
        {
            case LoadFormat.DOC_PRE_WORD_60:
                fileCopy(fileName, new File(pre97Dir + nameOnly).getPath());
                break;
            case LoadFormat.UNKNOWN:
                fileCopy(fileName, new File(unknownDir + nameOnly).getPath());
                break;
            default:
                fileCopy(fileName, new File(supportedDir + nameOnly).getPath());
                break;
        }
    }
}</pre></example>
<HR>
<P>

<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<P>

<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" RULES="GROUPS" FRAME="BOX" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<COLGROUP></COLGROUP><COLGROUP SPAN="2"></COLGROUP><THEAD><TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="3"><FONT SIZE="+2">
<B>Method Summary</B></FONT></TH>
</TR></THEAD>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ROWSPAN="2" ALIGN="right" VALIGN="top" WIDTH="1%">
<CODE>static&nbsp;int</CODE></TD><TD><CODE><B><A HREF="#contentTypeToLoadFormat(java.lang.String)">contentTypeToLoadFormat</A></B>(java.lang.String&nbsp;contentType)</CODE></TD><TD ALIGN="right" ></TD>
</TR><TR><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Converts IANA content type into a load format enumerated value.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ROWSPAN="2" ALIGN="right" VALIGN="top" WIDTH="1%">
<CODE>static&nbsp;int</CODE></TD><TD><CODE><B><A HREF="#contentTypeToSaveFormat(java.lang.String)">contentTypeToSaveFormat</A></B>(java.lang.String&nbsp;contentType)</CODE></TD><TD ALIGN="right" ></TD>
</TR><TR><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Converts IANA content type into a save format enumerated value.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ROWSPAN="2" ALIGN="right" VALIGN="top" WIDTH="1%">
<CODE>static&nbsp;<A HREF="FileFormatInfo.html" title="class in com.aspose.words">FileFormatInfo</A></CODE></TD><TD><CODE><B><A HREF="#detectFileFormat(java.io.InputStream)">detectFileFormat</A></B>(java.io.InputStream&nbsp;stream)</CODE></TD><TD ALIGN="right" ></TD>
</TR><TR><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Detects and returns the information about a format of a document stored in a stream.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ROWSPAN="2" ALIGN="right" VALIGN="top" WIDTH="1%">
<CODE>static&nbsp;<A HREF="FileFormatInfo.html" title="class in com.aspose.words">FileFormatInfo</A></CODE></TD><TD><CODE><B><A HREF="#detectFileFormat(java.lang.String)">detectFileFormat</A></B>(java.lang.String&nbsp;fileName)</CODE></TD><TD ALIGN="right" ></TD>
</TR><TR><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Detects and returns the information about a format of a document stored in a disk file.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ROWSPAN="2" ALIGN="right" VALIGN="top" WIDTH="1%">
<CODE>static&nbsp;int</CODE></TD><TD><CODE><B><A HREF="#extensionToSaveFormat(java.lang.String)">extensionToSaveFormat</A></B>(java.lang.String&nbsp;extension)</CODE></TD><TD ALIGN="right" ></TD>
</TR><TR><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Converts a file name extension into a <cref><A HREF="SaveFormat.html" title="Utility class in com.aspose.words">SaveFormat</A></cref> value.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ROWSPAN="2" ALIGN="right" VALIGN="top" WIDTH="1%">
<CODE>static&nbsp;java.lang.String</CODE></TD><TD><CODE><B><A HREF="#imageTypeToExtension(int)">imageTypeToExtension</A></B>(int&nbsp;imageType)</CODE></TD><TD ALIGN="right" ></TD>
</TR><TR><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Converts an Aspose.Words image type enumerated value into a file extension. The returned extension is a lower-case string with a leading dot.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ROWSPAN="2" ALIGN="right" VALIGN="top" WIDTH="1%">
<CODE>static&nbsp;java.lang.String</CODE></TD><TD><CODE><B><A HREF="#loadFormatToExtension(int)">loadFormatToExtension</A></B>(int&nbsp;loadFormat)</CODE></TD><TD ALIGN="right" ></TD>
</TR><TR><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Converts a load format enumerated value into a file extension. The returned extension is a lower-case string with a leading dot.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ROWSPAN="2" ALIGN="right" VALIGN="top" WIDTH="1%">
<CODE>static&nbsp;int</CODE></TD><TD><CODE><B><A HREF="#loadFormatToSaveFormat(int)">loadFormatToSaveFormat</A></B>(int&nbsp;loadFormat)</CODE></TD><TD ALIGN="right" ></TD>
</TR><TR><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Converts a <cref><A HREF="LoadFormat.html" title="Utility class in com.aspose.words">LoadFormat</A></cref> value to a <cref><A HREF="SaveFormat.html" title="Utility class in com.aspose.words">SaveFormat</A></cref> value if possible.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ROWSPAN="2" ALIGN="right" VALIGN="top" WIDTH="1%">
<CODE>static&nbsp;java.lang.String</CODE></TD><TD><CODE><B><A HREF="#saveFormatToExtension(int)">saveFormatToExtension</A></B>(int&nbsp;saveFormat)</CODE></TD><TD ALIGN="right" ></TD>
</TR><TR><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Converts a save format enumerated value into a file extension. The returned extension is a lower-case string with a leading dot.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ROWSPAN="2" ALIGN="right" VALIGN="top" WIDTH="1%">
<CODE>static&nbsp;int</CODE></TD><TD><CODE><B><A HREF="#saveFormatToLoadFormat(int)">saveFormatToLoadFormat</A></B>(int&nbsp;saveFormat)</CODE></TD><TD ALIGN="right" ></TD>
</TR><TR><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Converts a <cref><A HREF="SaveFormat.html" title="Utility class in com.aspose.words">SaveFormat</A></cref> value to a <cref><A HREF="LoadFormat.html" title="Utility class in com.aspose.words">LoadFormat</A></cref> value if possible.
            </TD>
</TR></TBODY>
</TABLE>&nbsp;<P>

<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Method Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="contentTypeToLoadFormat(java.lang.String)"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>contentTypeToLoadFormat</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public static&nbsp;int&nbsp;<B>contentTypeToLoadFormat</B>(java.lang.String&nbsp;contentType)</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Converts IANA content type into a load format enumerated value.
            </summary>
</DL>
<HR>

<A NAME="contentTypeToSaveFormat(java.lang.String)"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>contentTypeToSaveFormat</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public static&nbsp;int&nbsp;<B>contentTypeToSaveFormat</B>(java.lang.String&nbsp;contentType)</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Converts IANA content type into a save format enumerated value.
            </summary>
</DL>
<HR>

<A NAME="detectFileFormat(java.io.InputStream)"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>detectFileFormat</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public static&nbsp;<A HREF="FileFormatInfo.html" title="class in com.aspose.words">FileFormatInfo</A>&nbsp;<B>detectFileFormat</B>(java.io.InputStream&nbsp;stream)
                                           throws java.lang.Exception</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Detects and returns the information about a format of a document stored in a stream.
            </summary><remarks><p>The stream must be positioned at the beginning of the document.</p><p>Detecting a file format might require seeking to various positions in the stream. Because java.io.InputStream 
            is not seekable, this method loads the whole stream into memory temporarily. When this method returns,
            the stream is positioned at the end of the document.</p><p>Even if this method detects the document format, it does not guarantee 
            that the specified document is valid. This method only detects the document format by 
            reading data that is sufficient for detection. To fully verify that a document is valid 
            you need to load the document into a <cref><A HREF="Document.html" title="class in com.aspose.words">Document</A></cref> object.</p><p>This method throws <cref><A HREF="FileCorruptedException.html" title="class in com.aspose.words">FileCorruptedException</A></cref> when the format is 
            recognized, but the detection cannot complete because of corruption.</p></remarks><DL><DT><B>Parameters:</B></DT><DD param="stream"><CODE>stream</CODE> - The stream.</DD></DL><DL><DT><B>Returns:</B></DT><DD returns="">A <cref><A HREF="FileFormatInfo.html" title="class in com.aspose.words">FileFormatInfo</A></cref> object that contains the detected information.</DD></DL><example><p><b>Example:</b></p>Shows how to use the FileFormatUtil methods to detect the format of a document without any extension and save it with the correct file extension.<pre>
// Load the document without a file extension into a stream and use the DetectFileFormat method to detect it's format. 
// These are both times where you might need extract the file format as it's not visible
FileInputStream docStream = new FileInputStream(getMyDir() + "Document.FileWithoutExtension"); // The file format of this document is actually ".doc"
FileFormatInfo info = FileFormatUtil.detectFileFormat(docStream);

// Retrieve the LoadFormat of the document.
int loadFormat = info.getLoadFormat();

// Let's show the different methods of converting LoadFormat enumerations to SaveFormat enumerations.
//
// Method #1
// Convert the LoadFormat to a string first for working with. The string will include the leading dot infront of the extension.
String fileExtension = FileFormatUtil.loadFormatToExtension(loadFormat);
// Now convert this extension into the corresponding SaveFormat enumeration
int saveFormat = FileFormatUtil.extensionToSaveFormat(fileExtension);

// Method #2
// Convert the LoadFormat enumeration directly to the SaveFormat enumeration.
saveFormat = FileFormatUtil.loadFormatToSaveFormat(loadFormat);


// Load a document from the stream.
// Note that in Java we cannot reuse the same InputStream instance that was used for file format detection because InputStream is not seekable.
docStream = new FileInputStream(getMyDir() + "Document.FileWithoutExtension"); // The file format of this document is actually ".doc"
Document doc = new Document(docStream);

// Save the document with the original file name, " Out" and the document's file extension.
doc.save(getMyDir() + "\\Artifacts\\Document.WithFileExtension" + FileFormatUtil.saveFormatToExtension(saveFormat));</pre></example>
</DL>
<HR>

<A NAME="detectFileFormat(java.lang.String)"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>detectFileFormat</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public static&nbsp;<A HREF="FileFormatInfo.html" title="class in com.aspose.words">FileFormatInfo</A>&nbsp;<B>detectFileFormat</B>(java.lang.String&nbsp;fileName)
                                           throws java.lang.Exception</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Detects and returns the information about a format of a document stored in a disk file.
            </summary><remarks><p>Even if this method detects the document format, it does not guarantee 
            that the specified document is valid. This method only detects the document format by 
            reading data that is sufficient for detection. To fully verify that a document is valid 
            you need to load the document into a <cref><A HREF="Document.html" title="class in com.aspose.words">Document</A></cref> object.</p><p>This method throws <cref><A HREF="FileCorruptedException.html" title="class in com.aspose.words">FileCorruptedException</A></cref> when the format is 
            recognized, but the detection cannot complete because of corruption.</p></remarks><DL><DT><B>Parameters:</B></DT><DD param="fileName"><CODE>fileName</CODE> - The file name.</DD></DL><DL><DT><B>Returns:</B></DT><DD returns="">A <cref><A HREF="FileFormatInfo.html" title="class in com.aspose.words">FileFormatInfo</A></cref> object that contains the detected information.</DD></DL><example><p><b>Example:</b></p>Check each file in the folder and move it to the appropriate subfolder.<pre>
// Loop through all found files.
for (File file : fileList)
{
    if (file.isDirectory())
        continue;

    // Extract and display the file name without the path.
    String nameOnly = file.getName();
    System.out.print(nameOnly);

    // Check the file format and move the file to the appropriate folder.
    String fileName = file.getPath();
    FileFormatInfo info = FileFormatUtil.detectFileFormat(fileName);

    // Display the document type.
    switch (info.getLoadFormat())
    {
        case LoadFormat.DOC:
            System.out.println("\tMicrosoft Word 97-2003 document.");
            break;
        case LoadFormat.DOT:
            System.out.println("\tMicrosoft Word 97-2003 template.");
            break;
        case LoadFormat.DOCX:
            System.out.println("\tOffice Open XML WordprocessingML Macro-Free Document.");
            break;
        case LoadFormat.DOCM:
            System.out.println("\tOffice Open XML WordprocessingML Macro-Enabled Document.");
            break;
        case LoadFormat.DOTX:
            System.out.println("\tOffice Open XML WordprocessingML Macro-Free Template.");
            break;
        case LoadFormat.DOTM:
            System.out.println("\tOffice Open XML WordprocessingML Macro-Enabled Template.");
            break;
        case LoadFormat.FLAT_OPC:
            System.out.println("\tFlat OPC document.");
            break;
        case LoadFormat.RTF:
            System.out.println("\tRTF format.");
            break;
        case LoadFormat.WORD_ML:
            System.out.println("\tMicrosoft Word 2003 WordprocessingML format.");
            break;
        case LoadFormat.HTML:
            System.out.println("\tHTML format.");
            break;
        case LoadFormat.MHTML:
            System.out.println("\tMHTML (Web archive) format.");
            break;
        case LoadFormat.ODT:
            System.out.println("\tOpenDocument Text.");
            break;
        case LoadFormat.OTT:
            System.out.println("\tOpenDocument Text Template.");
            break;
        case LoadFormat.DOC_PRE_WORD_60:
            System.out.println("\tMS Word 6 or Word 95 format.");
            break;
        case LoadFormat.UNKNOWN:
        default:
            System.out.println("\tUnknown format.");
            break;
    }

    // Now copy the document into the appropriate folder.
    if (info.isEncrypted())
    {
        System.out.println("\tAn encrypted document.");
        fileCopy(fileName, new File(encryptedDir, nameOnly).getPath());
    }
    else
    {
        switch (info.getLoadFormat())
        {
            case LoadFormat.DOC_PRE_WORD_60:
                fileCopy(fileName, new File(pre97Dir + nameOnly).getPath());
                break;
            case LoadFormat.UNKNOWN:
                fileCopy(fileName, new File(unknownDir + nameOnly).getPath());
                break;
            default:
                fileCopy(fileName, new File(supportedDir + nameOnly).getPath());
                break;
        }
    }
}</pre></example><example><p><b>Example:</b></p>Shows how to check a document for digital signatures before loading it into a Document object.<pre>
// The path to the document which is to be processed.
String filePath = getMyDir() + "Document.Signed.docx";

FileFormatInfo info = FileFormatUtil.detectFileFormat(filePath);
if (info.hasDigitalSignature())
{
    System.out.println(java.text.MessageFormat.format("Document {0} has digital signatures, they will be lost if you open/save this document with Aspose.Words.", new File(filePath).getName()));
}</pre></example><example><p><b>Example:</b></p>Shows how to use the FileFormatUtil class to detect the document format and other features of the document.<pre>
FileFormatInfo info = FileFormatUtil.detectFileFormat(getMyDir() + "Document.doc");
System.out.println("The document format is: " + FileFormatUtil.loadFormatToExtension(info.getLoadFormat()));
System.out.println("Document is encrypted: " + info.isEncrypted());
System.out.println("Document has a digital signature: " + info.hasDigitalSignature());</pre></example>
</DL>
<HR>

<A NAME="extensionToSaveFormat(java.lang.String)"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>extensionToSaveFormat</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public static&nbsp;int&nbsp;<B>extensionToSaveFormat</B>(java.lang.String&nbsp;extension)</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Converts a file name extension into a <cref><A HREF="SaveFormat.html" title="Utility class in com.aspose.words">SaveFormat</A></cref> value.
            </summary><remarks><p>If the extension cannot be recognized, returns <cref><A HREF="SaveFormat.html#UNKNOWN" title="field in class com.aspose.words.SaveFormat">SaveFormat.UNKNOWN</A></cref>.</p></remarks><DL><DT><B>Parameters:</B></DT><DD param="extension"><CODE>extension</CODE> - The file extension. Can be with or without a leading dot. Case-insensitive.</DD></DL><example><p><b>Example:</b></p>Shows how to use the FileFormatUtil methods to detect the format of a document without any extension and save it with the correct file extension.<pre>
// Load the document without a file extension into a stream and use the DetectFileFormat method to detect it's format. 
// These are both times where you might need extract the file format as it's not visible
FileInputStream docStream = new FileInputStream(getMyDir() + "Document.FileWithoutExtension"); // The file format of this document is actually ".doc"
FileFormatInfo info = FileFormatUtil.detectFileFormat(docStream);

// Retrieve the LoadFormat of the document.
int loadFormat = info.getLoadFormat();

// Let's show the different methods of converting LoadFormat enumerations to SaveFormat enumerations.
//
// Method #1
// Convert the LoadFormat to a string first for working with. The string will include the leading dot infront of the extension.
String fileExtension = FileFormatUtil.loadFormatToExtension(loadFormat);
// Now convert this extension into the corresponding SaveFormat enumeration
int saveFormat = FileFormatUtil.extensionToSaveFormat(fileExtension);

// Method #2
// Convert the LoadFormat enumeration directly to the SaveFormat enumeration.
saveFormat = FileFormatUtil.loadFormatToSaveFormat(loadFormat);


// Load a document from the stream.
// Note that in Java we cannot reuse the same InputStream instance that was used for file format detection because InputStream is not seekable.
docStream = new FileInputStream(getMyDir() + "Document.FileWithoutExtension"); // The file format of this document is actually ".doc"
Document doc = new Document(docStream);

// Save the document with the original file name, " Out" and the document's file extension.
doc.save(getMyDir() + "\\Artifacts\\Document.WithFileExtension" + FileFormatUtil.saveFormatToExtension(saveFormat));</pre></example>
</DL>
<HR>

<A NAME="imageTypeToExtension(int)"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>imageTypeToExtension</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public static&nbsp;java.lang.String&nbsp;<B>imageTypeToExtension</B>(int&nbsp;imageType)</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Converts an Aspose.Words image type enumerated value into a file extension. The returned extension is a lower-case string with a leading dot.
            </summary><DL><DT><B>Parameters:</B></DT><DD><CODE>imageType</CODE> - A <A HREF="ImageType.html" title="Utility class in com.aspose.words">ImageType</A> value.</DD></DL><example><p><b>Example:</b></p>Shows how to extract images from a document and save them as files.<pre>
public void extractImagesToFiles() throws Exception
{
    Document doc = new Document(getMyDir() + "Image.SampleImages.doc");

    NodeCollection shapes = doc.getChildNodes(NodeType.SHAPE, true);
    int imageIndex = 0;
    for (Shape shape : (Iterable&lt;Shape&gt;) shapes)
    {
        if (shape.hasImage())
        {
            String imageFileName = java.text.MessageFormat.format("\\Artifacts\\Image.ExportImages.{0} Out{1}", imageIndex, FileFormatUtil.imageTypeToExtension(shape.getImageData().getImageType()));
            shape.getImageData().save(getMyDir() + imageFileName);
            imageIndex++;
        }
    }
}</pre></example>
</DL>
<HR>

<A NAME="loadFormatToExtension(int)"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>loadFormatToExtension</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public static&nbsp;java.lang.String&nbsp;<B>loadFormatToExtension</B>(int&nbsp;loadFormat)</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Converts a load format enumerated value into a file extension. The returned extension is a lower-case string with a leading dot.
            </summary><remarks><p>The <cref><A HREF="SaveFormat.html#WORD_ML" title="field in class com.aspose.words.SaveFormat">SaveFormat.WORD_ML</A></cref> value is converted to ".wml".</p></remarks><DL><DT><B>Parameters:</B></DT><DD><CODE>loadFormat</CODE> - A <A HREF="LoadFormat.html" title="Utility class in com.aspose.words">LoadFormat</A> value.</DD></DL><example><p><b>Example:</b></p>Shows how to use the FileFormatUtil methods to detect the format of a document without any extension and save it with the correct file extension.<pre>
// Load the document without a file extension into a stream and use the DetectFileFormat method to detect it's format. 
// These are both times where you might need extract the file format as it's not visible
FileInputStream docStream = new FileInputStream(getMyDir() + "Document.FileWithoutExtension"); // The file format of this document is actually ".doc"
FileFormatInfo info = FileFormatUtil.detectFileFormat(docStream);

// Retrieve the LoadFormat of the document.
int loadFormat = info.getLoadFormat();

// Let's show the different methods of converting LoadFormat enumerations to SaveFormat enumerations.
//
// Method #1
// Convert the LoadFormat to a string first for working with. The string will include the leading dot infront of the extension.
String fileExtension = FileFormatUtil.loadFormatToExtension(loadFormat);
// Now convert this extension into the corresponding SaveFormat enumeration
int saveFormat = FileFormatUtil.extensionToSaveFormat(fileExtension);

// Method #2
// Convert the LoadFormat enumeration directly to the SaveFormat enumeration.
saveFormat = FileFormatUtil.loadFormatToSaveFormat(loadFormat);


// Load a document from the stream.
// Note that in Java we cannot reuse the same InputStream instance that was used for file format detection because InputStream is not seekable.
docStream = new FileInputStream(getMyDir() + "Document.FileWithoutExtension"); // The file format of this document is actually ".doc"
Document doc = new Document(docStream);

// Save the document with the original file name, " Out" and the document's file extension.
doc.save(getMyDir() + "\\Artifacts\\Document.WithFileExtension" + FileFormatUtil.saveFormatToExtension(saveFormat));</pre></example>
</DL>
<HR>

<A NAME="loadFormatToSaveFormat(int)"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>loadFormatToSaveFormat</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public static&nbsp;int&nbsp;<B>loadFormatToSaveFormat</B>(int&nbsp;loadFormat)</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Converts a <cref><A HREF="LoadFormat.html" title="Utility class in com.aspose.words">LoadFormat</A></cref> value to a <cref><A HREF="SaveFormat.html" title="Utility class in com.aspose.words">SaveFormat</A></cref> value if possible.
            </summary><DL><DT><B>Parameters:</B></DT><DD><CODE>loadFormat</CODE> - A <A HREF="LoadFormat.html" title="Utility class in com.aspose.words">LoadFormat</A> value.</DD></DL><example><p><b>Example:</b></p>Shows how to use the FileFormatUtil methods to detect the format of a document without any extension and save it with the correct file extension.<pre>
// Load the document without a file extension into a stream and use the DetectFileFormat method to detect it's format. 
// These are both times where you might need extract the file format as it's not visible
FileInputStream docStream = new FileInputStream(getMyDir() + "Document.FileWithoutExtension"); // The file format of this document is actually ".doc"
FileFormatInfo info = FileFormatUtil.detectFileFormat(docStream);

// Retrieve the LoadFormat of the document.
int loadFormat = info.getLoadFormat();

// Let's show the different methods of converting LoadFormat enumerations to SaveFormat enumerations.
//
// Method #1
// Convert the LoadFormat to a string first for working with. The string will include the leading dot infront of the extension.
String fileExtension = FileFormatUtil.loadFormatToExtension(loadFormat);
// Now convert this extension into the corresponding SaveFormat enumeration
int saveFormat = FileFormatUtil.extensionToSaveFormat(fileExtension);

// Method #2
// Convert the LoadFormat enumeration directly to the SaveFormat enumeration.
saveFormat = FileFormatUtil.loadFormatToSaveFormat(loadFormat);


// Load a document from the stream.
// Note that in Java we cannot reuse the same InputStream instance that was used for file format detection because InputStream is not seekable.
docStream = new FileInputStream(getMyDir() + "Document.FileWithoutExtension"); // The file format of this document is actually ".doc"
Document doc = new Document(docStream);

// Save the document with the original file name, " Out" and the document's file extension.
doc.save(getMyDir() + "\\Artifacts\\Document.WithFileExtension" + FileFormatUtil.saveFormatToExtension(saveFormat));</pre></example>
</DL>
<HR>

<A NAME="saveFormatToExtension(int)"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>saveFormatToExtension</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public static&nbsp;java.lang.String&nbsp;<B>saveFormatToExtension</B>(int&nbsp;saveFormat)</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Converts a save format enumerated value into a file extension. The returned extension is a lower-case string with a leading dot.
            </summary><remarks><p>The <cref><A HREF="SaveFormat.html#WORD_ML" title="field in class com.aspose.words.SaveFormat">SaveFormat.WORD_ML</A></cref> value is converted to ".wml".</p><p>The <cref><A HREF="SaveFormat.html#FLAT_OPC" title="field in class com.aspose.words.SaveFormat">SaveFormat.FLAT_OPC</A></cref> value is converted to ".fopc".</p></remarks><DL><DT><B>Parameters:</B></DT><DD><CODE>saveFormat</CODE> - A <A HREF="SaveFormat.html" title="Utility class in com.aspose.words">SaveFormat</A> value.</DD></DL><example><p><b>Example:</b></p>Shows how to use the FileFormatUtil methods to detect the format of a document without any extension and save it with the correct file extension.<pre>
// Load the document without a file extension into a stream and use the DetectFileFormat method to detect it's format. 
// These are both times where you might need extract the file format as it's not visible
FileInputStream docStream = new FileInputStream(getMyDir() + "Document.FileWithoutExtension"); // The file format of this document is actually ".doc"
FileFormatInfo info = FileFormatUtil.detectFileFormat(docStream);

// Retrieve the LoadFormat of the document.
int loadFormat = info.getLoadFormat();

// Let's show the different methods of converting LoadFormat enumerations to SaveFormat enumerations.
//
// Method #1
// Convert the LoadFormat to a string first for working with. The string will include the leading dot infront of the extension.
String fileExtension = FileFormatUtil.loadFormatToExtension(loadFormat);
// Now convert this extension into the corresponding SaveFormat enumeration
int saveFormat = FileFormatUtil.extensionToSaveFormat(fileExtension);

// Method #2
// Convert the LoadFormat enumeration directly to the SaveFormat enumeration.
saveFormat = FileFormatUtil.loadFormatToSaveFormat(loadFormat);


// Load a document from the stream.
// Note that in Java we cannot reuse the same InputStream instance that was used for file format detection because InputStream is not seekable.
docStream = new FileInputStream(getMyDir() + "Document.FileWithoutExtension"); // The file format of this document is actually ".doc"
Document doc = new Document(docStream);

// Save the document with the original file name, " Out" and the document's file extension.
doc.save(getMyDir() + "\\Artifacts\\Document.WithFileExtension" + FileFormatUtil.saveFormatToExtension(saveFormat));</pre></example>
</DL>
<HR>

<A NAME="saveFormatToLoadFormat(int)"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>saveFormatToLoadFormat</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public static&nbsp;int&nbsp;<B>saveFormatToLoadFormat</B>(int&nbsp;saveFormat)</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Converts a <cref><A HREF="SaveFormat.html" title="Utility class in com.aspose.words">SaveFormat</A></cref> value to a <cref><A HREF="LoadFormat.html" title="Utility class in com.aspose.words">LoadFormat</A></cref> value if possible.
            </summary><DL><DT><B>Parameters:</B></DT><DD><CODE>saveFormat</CODE> - A <A HREF="SaveFormat.html" title="Utility class in com.aspose.words">SaveFormat</A> value.</DD></DL><example><p><b>Example:</b></p>Shows how to use the FileFormatUtil class and to convert a SaveFormat enumeration into the corresponding LoadFormat enumeration.<pre>
// Define the SaveFormat enumeration to convert.
int saveFormat = SaveFormat.HTML;
// Convert the SaveFormat enumeration to LoadFormat enumeration.
int loadFormat = FileFormatUtil.saveFormatToLoadFormat(saveFormat);
System.out.println("The converted LoadFormat is: " + FileFormatUtil.loadFormatToExtension(loadFormat));</pre></example>
</DL>
<HR>

<B>See Also:</B>
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A href="http://www.aspose.com/Products/Aspose.Words/Api/index.html" TARGET="_blank">Aspose.Words Documentation</A> - the home page for the Aspose.Words Product Documentation.<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A href="http://www.aspose.com/Community/forums/ShowForum.aspx?ForumID=75" TARGET="_blank">Aspose.Words Support Forum</A> - our preferred method of support.<P>
<div class="footer"><hr><p><a href='http://www.aspose.com/Wiki/default.aspx/Aspose.Corporate/ContactAspose.html'>We guarantee a prompt response to any inquiry!</a></p><p>&copy; 2003-2007 Aspose Pty Ltd. All rights reserved.</p></div></BODY></HTML>