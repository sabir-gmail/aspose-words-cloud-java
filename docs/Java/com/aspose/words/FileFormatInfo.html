<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"
><HTML>
<HEAD>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<!-- Generated by javadoc - compatibility string-->
<!-- Generated by Aspose.JavaDoc 09 Aug 2018 -->
<TITLE>FileFormatInfo</TITLE>
<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../stylesheet.css" TITLE="Style"></HEAD>
<BODY BGCOLOR="white">
<!-- ======== START OF CLASS DATA ======== -->
<H2><a href="package-summary.html"><FONT SIZE="-1">
com.aspose.words
</FONT></a><BR>Class FileFormatInfo</H2>
<PRE>
java.lang.Object
    <IMG SRC="../../../resources/inherit.gif" ALT="extended by "><B>com.aspose.words.FileFormatInfo</B>
</PRE>
<HR>
<DL>
<DT><PRE>public class <B>FileFormatInfo </B><DT>extends java.lang.Object</DL>
</PRE>

<P>

<summary>
            Contains data returned by <cref><A HREF="FileFormatUtil.html" title="class in com.aspose.words">FileFormatUtil</A></cref> document format detection methods.
            </summary><remarks><p>You do not create instances of this class directly. Objects of this class are returned by 
            <cref><A HREF="FileFormatUtil.html#detectFileFormat(java.io.InputStream)" title="method in class com.aspose.words.FileFormatUtil">FileFormatUtil.detectFileFormat(java.io.InputStream)</A></cref> methods.</p></remarks><example><p><b>Example:</b></p>Shows how to use the FileFormatUtil class to detect the document format and other features of the document.<pre>
FileFormatInfo info = FileFormatUtil.detectFileFormat(getMyDir() + "Document.doc");
System.out.println("The document format is: " + FileFormatUtil.loadFormatToExtension(info.getLoadFormat()));
System.out.println("Document is encrypted: " + info.isEncrypted());
System.out.println("Document has a digital signature: " + info.hasDigitalSignature());</pre></example><example><p><b>Example:</b></p>Check each file in the folder and move it to the appropriate subfolder.<pre>
// Loop through all found files.
for (File file : fileList)
{
    if (file.isDirectory())
        continue;

    // Extract and display the file name without the path.
    String nameOnly = file.getName();
    System.out.print(nameOnly);

    // Check the file format and move the file to the appropriate folder.
    String fileName = file.getPath();
    FileFormatInfo info = FileFormatUtil.detectFileFormat(fileName);

    // Display the document type.
    switch (info.getLoadFormat())
    {
        case LoadFormat.DOC:
            System.out.println("\tMicrosoft Word 97-2003 document.");
            break;
        case LoadFormat.DOT:
            System.out.println("\tMicrosoft Word 97-2003 template.");
            break;
        case LoadFormat.DOCX:
            System.out.println("\tOffice Open XML WordprocessingML Macro-Free Document.");
            break;
        case LoadFormat.DOCM:
            System.out.println("\tOffice Open XML WordprocessingML Macro-Enabled Document.");
            break;
        case LoadFormat.DOTX:
            System.out.println("\tOffice Open XML WordprocessingML Macro-Free Template.");
            break;
        case LoadFormat.DOTM:
            System.out.println("\tOffice Open XML WordprocessingML Macro-Enabled Template.");
            break;
        case LoadFormat.FLAT_OPC:
            System.out.println("\tFlat OPC document.");
            break;
        case LoadFormat.RTF:
            System.out.println("\tRTF format.");
            break;
        case LoadFormat.WORD_ML:
            System.out.println("\tMicrosoft Word 2003 WordprocessingML format.");
            break;
        case LoadFormat.HTML:
            System.out.println("\tHTML format.");
            break;
        case LoadFormat.MHTML:
            System.out.println("\tMHTML (Web archive) format.");
            break;
        case LoadFormat.ODT:
            System.out.println("\tOpenDocument Text.");
            break;
        case LoadFormat.OTT:
            System.out.println("\tOpenDocument Text Template.");
            break;
        case LoadFormat.DOC_PRE_WORD_60:
            System.out.println("\tMS Word 6 or Word 95 format.");
            break;
        case LoadFormat.UNKNOWN:
        default:
            System.out.println("\tUnknown format.");
            break;
    }

    // Now copy the document into the appropriate folder.
    if (info.isEncrypted())
    {
        System.out.println("\tAn encrypted document.");
        fileCopy(fileName, new File(encryptedDir, nameOnly).getPath());
    }
    else
    {
        switch (info.getLoadFormat())
        {
            case LoadFormat.DOC_PRE_WORD_60:
                fileCopy(fileName, new File(pre97Dir + nameOnly).getPath());
                break;
            case LoadFormat.UNKNOWN:
                fileCopy(fileName, new File(unknownDir + nameOnly).getPath());
                break;
            default:
                fileCopy(fileName, new File(supportedDir + nameOnly).getPath());
                break;
        }
    }
}</pre></example>
<HR>
<P>

<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<P>

<!-- ========== PROPERTY SUMMARY =========== -->

<A NAME="property_summary"><!-- --></A>
<TABLE RULES="GROUPS" BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<COLGROUP></COLGROUP><COLGROUP SPAN="2"></COLGROUP><THEAD><TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="3"><FONT SIZE="+2">
<B>Property Getters/Setters Summary</B></FONT></TH>
</TR></THEAD>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE>java.nio.charset.Charset</CODE></TD><TD><CODE><B><A HREF="#Encoding">getEncoding</A></B>()</CODE></TD><TD ALIGN="right" ></TD></TR><TR><TD></TD><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Gets the detected encoding if applicable to the current document format.
            At the moment detects encoding only for HTML documents.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE>boolean</CODE></TD><TD><CODE><B><A HREF="#HasDigitalSignature">hasDigitalSignature</A></B>()</CODE></TD><TD ALIGN="right" ></TD></TR><TR><TD></TD><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Returns true if this document contains a digital signature. 
            This property merely informs that a digital signature is present on a document, 
            but it does not  specify whether the signature is valid or not.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE>boolean</CODE></TD><TD><CODE><B><A HREF="#IsEncrypted">isEncrypted</A></B>()</CODE></TD><TD ALIGN="right" ></TD></TR><TR><TD></TD><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Returns true if the document is encrypted and requires a password to open.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE>int</CODE></TD><TD><CODE><B><A HREF="#LoadFormat">getLoadFormat</A></B>()</CODE></TD><TD ALIGN="right" ></TD></TR><TR><TD></TD><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Gets the detected document format.
            The value of the property is <A HREF="LoadFormat.html" title="Utility class in com.aspose.words">LoadFormat</A> integer constant.</TD>
</TR></TBODY>
</TABLE>&nbsp;<P>

<!-- ============ PROPERTY DETAIL ========== -->

<A NAME="property_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Property Getters/Setters Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="Encoding"><!-- --></A><A NAME="getEncoding()"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>getEncoding</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public java.nio.charset.Charset&nbsp;<B>getEncoding</B>()
</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Gets the detected encoding if applicable to the current document format.
            At the moment detects encoding only for HTML documents.
            </summary>
</DL>
<HR>

<A NAME="HasDigitalSignature"><!-- --></A><A NAME="hasDigitalSignature()"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>hasDigitalSignature</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public boolean&nbsp;<B>hasDigitalSignature</B>()
</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Returns true if this document contains a digital signature. 
            This property merely informs that a digital signature is present on a document, 
            but it does not  specify whether the signature is valid or not.
            </summary><remarks><p>This property exists to help you sort documents that are digitally signed from those that are not.
            If you use Aspose.Words to modify and save a document that is digitally signed, then the digital signature will 
            be lost. This is by design because a digital signature exists to guard the authenticity of a document. 
            Using this property you can detect digitally signed documents before processing them in the same way as normal 
            documents and take some action to avoid losing the digital signature, for example notify the user.
            </p></remarks><example><p><b>Example:</b></p>Shows how to use the FileFormatUtil class to detect the document format and other features of the document.<pre>
FileFormatInfo info = FileFormatUtil.detectFileFormat(getMyDir() + "Document.doc");
System.out.println("The document format is: " + FileFormatUtil.loadFormatToExtension(info.getLoadFormat()));
System.out.println("Document is encrypted: " + info.isEncrypted());
System.out.println("Document has a digital signature: " + info.hasDigitalSignature());</pre></example><example><p><b>Example:</b></p>Shows how to check a document for digital signatures before loading it into a Document object.<pre>
// The path to the document which is to be processed.
String filePath = getMyDir() + "Document.Signed.docx";

FileFormatInfo info = FileFormatUtil.detectFileFormat(filePath);
if (info.hasDigitalSignature())
{
    System.out.println(java.text.MessageFormat.format("Document {0} has digital signatures, they will be lost if you open/save this document with Aspose.Words.", new File(filePath).getName()));
}</pre></example>
</DL>
<HR>

<A NAME="IsEncrypted"><!-- --></A><A NAME="isEncrypted()"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>isEncrypted</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public boolean&nbsp;<B>isEncrypted</B>()
</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Returns true if the document is encrypted and requires a password to open.
            </summary><remarks><p>This property exists to help you sort documents that are encrypted from those that are not.
            If you attempt to load an encrypted document using Aspose.Words without supplying a password an 
            exception will be thrown. You can use this property to detect whether a document requires a password 
            and take some action before loading a document, for example, prompt the user for a password. </p></remarks><example><p><b>Example:</b></p>Shows how to use the FileFormatUtil class to detect the document format and other features of the document.<pre>
FileFormatInfo info = FileFormatUtil.detectFileFormat(getMyDir() + "Document.doc");
System.out.println("The document format is: " + FileFormatUtil.loadFormatToExtension(info.getLoadFormat()));
System.out.println("Document is encrypted: " + info.isEncrypted());
System.out.println("Document has a digital signature: " + info.hasDigitalSignature());</pre></example><DL><DT><B>See Also:</B></DT><DD><cref seealso=""><A HREF="#LoadFormat" title="property in class com.aspose.words.FileFormatInfo">LoadFormat</A></cref></DD></DL>
</DL>
<HR>

<A NAME="LoadFormat"><!-- --></A><A NAME="getLoadFormat()"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>getLoadFormat</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public int&nbsp;<B>getLoadFormat</B>()
</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Gets the detected document format.
            The value of the property is <A HREF="LoadFormat.html" title="Utility class in com.aspose.words">LoadFormat</A> integer constant.</summary><remarks><p>When an OOXML document is encrypted, it is not possible to ascertained whether it is
            an Excel, Word or PowerPoint document without decrypting it first so for an encrypted OOXML
            document this property will always return <cref><A HREF="LoadFormat.html#DOCX" title="field in class com.aspose.words.LoadFormat">LoadFormat.DOCX</A></cref>.</p></remarks><example><p><b>Example:</b></p>Shows how to use the FileFormatUtil class to detect the document format and other features of the document.<pre>
FileFormatInfo info = FileFormatUtil.detectFileFormat(getMyDir() + "Document.doc");
System.out.println("The document format is: " + FileFormatUtil.loadFormatToExtension(info.getLoadFormat()));
System.out.println("Document is encrypted: " + info.isEncrypted());
System.out.println("Document has a digital signature: " + info.hasDigitalSignature());</pre></example><example><p><b>Example:</b></p>Shows how to use the FileFormatUtil methods to detect the format of a document without any extension and save it with the correct file extension.<pre>
// Load the document without a file extension into a stream and use the DetectFileFormat method to detect it's format. 
// These are both times where you might need extract the file format as it's not visible
FileInputStream docStream = new FileInputStream(getMyDir() + "Document.FileWithoutExtension"); // The file format of this document is actually ".doc"
FileFormatInfo info = FileFormatUtil.detectFileFormat(docStream);

// Retrieve the LoadFormat of the document.
int loadFormat = info.getLoadFormat();

// Let's show the different methods of converting LoadFormat enumerations to SaveFormat enumerations.
//
// Method #1
// Convert the LoadFormat to a string first for working with. The string will include the leading dot infront of the extension.
String fileExtension = FileFormatUtil.loadFormatToExtension(loadFormat);
// Now convert this extension into the corresponding SaveFormat enumeration
int saveFormat = FileFormatUtil.extensionToSaveFormat(fileExtension);

// Method #2
// Convert the LoadFormat enumeration directly to the SaveFormat enumeration.
saveFormat = FileFormatUtil.loadFormatToSaveFormat(loadFormat);


// Load a document from the stream.
// Note that in Java we cannot reuse the same InputStream instance that was used for file format detection because InputStream is not seekable.
docStream = new FileInputStream(getMyDir() + "Document.FileWithoutExtension"); // The file format of this document is actually ".doc"
Document doc = new Document(docStream);

// Save the document with the original file name, " Out" and the document's file extension.
doc.save(getMyDir() + "\\Artifacts\\Document.WithFileExtension" + FileFormatUtil.saveFormatToExtension(saveFormat));</pre></example><DL><DT><B>See Also:</B></DT><DD><cref seealso=""><A HREF="#IsEncrypted" title="property in class com.aspose.words.FileFormatInfo">IsEncrypted</A></cref></DD></DL>
</DL>
<HR>

<B>See Also:</B>
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A href="http://www.aspose.com/Products/Aspose.Words/Api/index.html" TARGET="_blank">Aspose.Words Documentation</A> - the home page for the Aspose.Words Product Documentation.<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A href="http://www.aspose.com/Community/forums/ShowForum.aspx?ForumID=75" TARGET="_blank">Aspose.Words Support Forum</A> - our preferred method of support.<P>
<div class="footer"><hr><p><a href='http://www.aspose.com/Wiki/default.aspx/Aspose.Corporate/ContactAspose.html'>We guarantee a prompt response to any inquiry!</a></p><p>&copy; 2003-2007 Aspose Pty Ltd. All rights reserved.</p></div></BODY></HTML>