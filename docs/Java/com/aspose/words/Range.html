<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"
><HTML>
<HEAD>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<!-- Generated by javadoc - compatibility string-->
<!-- Generated by Aspose.JavaDoc 09 Aug 2018 -->
<TITLE>Range</TITLE>
<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../stylesheet.css" TITLE="Style"></HEAD>
<BODY BGCOLOR="white">
<!-- ======== START OF CLASS DATA ======== -->
<H2><a href="package-summary.html"><FONT SIZE="-1">
com.aspose.words
</FONT></a><BR>Class Range</H2>
<PRE>
java.lang.Object
    <IMG SRC="../../../resources/inherit.gif" ALT="extended by "><B>com.aspose.words.Range</B>
</PRE>
<HR>
<DL>
<DT><PRE>public class <B>Range </B><DT>extends java.lang.Object</DL>
</PRE>

<P>

<summary>
             Represents a contiguous area in a document.
             </summary><remarks><p>The document is represented by a tree of nodes and the nodes provide operations
             to work with the tree, but some operations are easier to perform if the document
             is treated as a contiguous sequence of text.</p><p><b>Range</b> is a "facade" interface that provide methods that treat the document
             or portions of the document as "flat" text regardless of the fact that the document
             nodes are stored in a tree-like object model.</p><p><b>Range</b> does not contain any text or nodes, it is merely a view or "window"
             over a fragment of a document.</p></remarks><example><p><b>Example:</b></p>Shows how to get plain, unformatted text of a range.<pre>
Document doc = new Document(getMyDir() + "Document.doc");
String text = doc.getRange().getText();</pre></example>
<HR>
<P>

<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<P>

<!-- ========== PROPERTY SUMMARY =========== -->

<A NAME="property_summary"><!-- --></A>
<TABLE RULES="GROUPS" BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<COLGROUP></COLGROUP><COLGROUP SPAN="2"></COLGROUP><THEAD><TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="3"><FONT SIZE="+2">
<B>Property Getters/Setters Summary</B></FONT></TH>
</TR></THEAD>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE><A HREF="BookmarkCollection.html" title="class in com.aspose.words">BookmarkCollection</A></CODE></TD><TD><CODE><B><A HREF="#Bookmarks">getBookmarks</A></B>()</CODE></TD><TD ALIGN="right" ></TD></TR><TR><TD></TD><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Returns a <cref><i>Bookmarks</i></cref> collection that represents all bookmarks in the range.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE><A HREF="FieldCollection.html" title="class in com.aspose.words">FieldCollection</A></CODE></TD><TD><CODE><B><A HREF="#Fields">getFields</A></B>()</CODE></TD><TD ALIGN="right" ></TD></TR><TR><TD></TD><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Returns a <cref><i>Fields</i></cref> collection that represents all fields in the range.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE><A HREF="FormFieldCollection.html" title="class in com.aspose.words">FormFieldCollection</A></CODE></TD><TD><CODE><B><A HREF="#FormFields">getFormFields</A></B>()</CODE></TD><TD ALIGN="right" ></TD></TR><TR><TD></TD><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Returns a <cref><i>FormFields</i></cref> collection that represents all form fields in the range.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE>java.lang.String</CODE></TD><TD><CODE><B><A HREF="#Text">getText</A></B>()</CODE></TD><TD ALIGN="right" ></TD></TR><TR><TD></TD><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Gets the text of the range.
            </TD>
</TR></TBODY>
</TABLE>&nbsp;

<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" RULES="GROUPS" FRAME="BOX" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<COLGROUP></COLGROUP><COLGROUP SPAN="2"></COLGROUP><THEAD><TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="3"><FONT SIZE="+2">
<B>Method Summary</B></FONT></TH>
</TR></THEAD>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ROWSPAN="2" ALIGN="right" VALIGN="top" WIDTH="1%">
<CODE>void</CODE></TD><TD><CODE><B><A HREF="#delete()">delete</A></B>()</CODE></TD><TD ALIGN="right" ></TD>
</TR><TR><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Deletes all characters of the range.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ROWSPAN="2" ALIGN="right" VALIGN="top" WIDTH="1%">
<CODE>void</CODE></TD><TD><CODE><B><A HREF="#normalizeFieldTypes()">normalizeFieldTypes</A></B>()</CODE></TD><TD ALIGN="right" ></TD>
</TR><TR><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Changes field type values <cref><A HREF="FieldChar.html#FieldType" title="property in class com.aspose.words.FieldChar">FieldChar.FieldType</A></cref> of <cref><A HREF="FieldStart.html" title="class in com.aspose.words">FieldStart</A></cref>, <cref><A HREF="FieldSeparator.html" title="class in com.aspose.words">FieldSeparator</A></cref>, <cref><A HREF="FieldEnd.html" title="class in com.aspose.words">FieldEnd</A></cref>
            in this range so that they correspond to the field types contained in the field codes.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ROWSPAN="2" ALIGN="right" VALIGN="top" WIDTH="1%">
<CODE>int</CODE></TD><TD><CODE><B><A HREF="#replace(java.lang.String,java.lang.String,boolean,boolean)">replace</A></B>(java.lang.String&nbsp;oldValue, java.lang.String&nbsp;newValue, boolean&nbsp;isMatchCase, boolean&nbsp;isMatchWholeWord)</CODE></TD><TD ALIGN="right" ></TD>
</TR><TR><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Replaces all occurrences of a specified string with another string.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ROWSPAN="2" ALIGN="right" VALIGN="top" WIDTH="1%">
<CODE>int</CODE></TD><TD><CODE><B><A HREF="#replace(java.lang.String,java.lang.String,com.aspose.words.FindReplaceOptions)">replace</A></B>(java.lang.String&nbsp;pattern, java.lang.String&nbsp;replacement, <A HREF="FindReplaceOptions.html" title="class in com.aspose.words">FindReplaceOptions</A>&nbsp;options)</CODE></TD><TD ALIGN="right" ></TD>
</TR><TR><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
             Replaces all occurrences of a character pattern specified by a regular expression with another string.
             </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ROWSPAN="2" ALIGN="right" VALIGN="top" WIDTH="1%">
<CODE>int</CODE></TD><TD><CODE><B><A HREF="#replace(java.util.regex.Pattern,com.aspose.words.IReplacingCallback,boolean)">replace</A></B>(java.util.regex.Pattern&nbsp;pattern, <A HREF="IReplacingCallback.html" title="interface in com.aspose.words">IReplacingCallback</A>&nbsp;handler, boolean&nbsp;isForward)</CODE></TD><TD ALIGN="right" ></TD>
</TR><TR><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Finds all occurrences of a character pattern specified by a regular expression and calls a
            user defined replace evaluator method.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ROWSPAN="2" ALIGN="right" VALIGN="top" WIDTH="1%">
<CODE>int</CODE></TD><TD><CODE><B><A HREF="#replace(java.util.regex.Pattern,java.lang.String)">replace</A></B>(java.util.regex.Pattern&nbsp;pattern, java.lang.String&nbsp;replacement)</CODE></TD><TD ALIGN="right" ></TD>
</TR><TR><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
             Replaces all occurrences of a character pattern specified by a regular expression with another string.
             </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ROWSPAN="2" ALIGN="right" VALIGN="top" WIDTH="1%">
<CODE>int</CODE></TD><TD><CODE><B><A HREF="#replace(java.util.regex.Pattern,java.lang.String,com.aspose.words.FindReplaceOptions)">replace</A></B>(java.util.regex.Pattern&nbsp;pattern, java.lang.String&nbsp;replacement, <A HREF="FindReplaceOptions.html" title="class in com.aspose.words">FindReplaceOptions</A>&nbsp;options)</CODE></TD><TD ALIGN="right" ></TD>
</TR><TR><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
             Replaces all occurrences of a character pattern specified by a regular expression with another string.
             </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ROWSPAN="2" ALIGN="right" VALIGN="top" WIDTH="1%">
<CODE><A HREF="Document.html" title="class in com.aspose.words">Document</A></CODE></TD><TD><CODE><B><A HREF="#toDocument()">toDocument</A></B>()</CODE></TD><TD ALIGN="right" ></TD>
</TR><TR><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Constructs a new fully formed document that contains the range.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ROWSPAN="2" ALIGN="right" VALIGN="top" WIDTH="1%">
<CODE>void</CODE></TD><TD><CODE><B><A HREF="#unlinkFields()">unlinkFields</A></B>()</CODE></TD><TD ALIGN="right" ></TD>
</TR><TR><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Unlinks fields in this range.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ROWSPAN="2" ALIGN="right" VALIGN="top" WIDTH="1%">
<CODE>void</CODE></TD><TD><CODE><B><A HREF="#updateFields()">updateFields</A></B>()</CODE></TD><TD ALIGN="right" ></TD>
</TR><TR><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Updates the values of document fields in this range.
            </TD>
</TR></TBODY>
</TABLE>&nbsp;<P>

<!-- ============ PROPERTY DETAIL ========== -->

<A NAME="property_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Property Getters/Setters Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="Bookmarks"><!-- --></A><A NAME="getBookmarks()"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>getBookmarks</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public <A HREF="BookmarkCollection.html" title="class in com.aspose.words">BookmarkCollection</A>&nbsp;<B>getBookmarks</B>()
</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Returns a <cref><i>Bookmarks</i></cref> collection that represents all bookmarks in the range.
            </summary><example><p><b>Example:</b></p>Shows how to get or set bookmark name and text.<pre>
Document doc = new Document(getMyDir() + "Bookmark.doc");

// Use the indexer of the Bookmarks collection to obtain the desired bookmark.
Bookmark bookmark = doc.getRange().getBookmarks().get("MyBookmark");

// Get the name and text of the bookmark.
String name = bookmark.getName();
String text = bookmark.getText();

// Set the name and text of the bookmark.
bookmark.setName("RenamedBookmark");
bookmark.setText("This is a new bookmarked text.");</pre></example>
</DL>
<HR>

<A NAME="Fields"><!-- --></A><A NAME="getFields()"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>getFields</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public <A HREF="FieldCollection.html" title="class in com.aspose.words">FieldCollection</A>&nbsp;<B>getFields</B>()
</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Returns a <cref><i>Fields</i></cref> collection that represents all fields in the range.
            </summary>
</DL>
<HR>

<A NAME="FormFields"><!-- --></A><A NAME="getFormFields()"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>getFormFields</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public <A HREF="FormFieldCollection.html" title="class in com.aspose.words">FormFieldCollection</A>&nbsp;<B>getFormFields</B>()
</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Returns a <cref><i>FormFields</i></cref> collection that represents all form fields in the range.
            </summary><example><p><b>Example:</b></p>Shows how to get a collection of form fields.<pre>
Document doc = new Document(getMyDir() + "FormFields.doc");
FormFieldCollection formFields = doc.getRange().getFormFields();</pre></example>
</DL>
<HR>

<A NAME="Text"><!-- --></A><A NAME="getText()"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>getText</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public java.lang.String&nbsp;<B>getText</B>()
</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Gets the text of the range.
            </summary><remarks><p>The returned string includes all control and special characters as described in <cref><A HREF="ControlChar.html" title="class in com.aspose.words">ControlChar</A></cref>.</p></remarks><example><p><b>Example:</b></p>Shows how to get plain, unformatted text of a range.<pre>
Document doc = new Document(getMyDir() + "Document.doc");
String text = doc.getRange().getText();</pre></example>
</DL>
<HR>



<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Method Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="delete()"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>delete</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public void&nbsp;<B>delete</B>()</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Deletes all characters of the range.
            </summary><example><p><b>Example:</b></p>Shows how to delete all characters of a range.<pre>
// Open Word document.
Document doc = new Document(getMyDir() + "Range.DeleteSection.doc");

// The document contains two sections. Each section has a paragraph of text.
System.out.println(doc.getText());

// Delete the first section from the document.
doc.getSections().get(0).getRange().delete();

// Check the first section was deleted by looking at the text of the whole document again.
System.out.println(doc.getText());</pre></example>
</DL>
<HR>

<A NAME="normalizeFieldTypes()"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>normalizeFieldTypes</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public void&nbsp;<B>normalizeFieldTypes</B>()</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Changes field type values <cref><A HREF="FieldChar.html#FieldType" title="property in class com.aspose.words.FieldChar">FieldChar.FieldType</A></cref> of <cref><A HREF="FieldStart.html" title="class in com.aspose.words">FieldStart</A></cref>, <cref><A HREF="FieldSeparator.html" title="class in com.aspose.words">FieldSeparator</A></cref>, <cref><A HREF="FieldEnd.html" title="class in com.aspose.words">FieldEnd</A></cref>
            in this range so that they correspond to the field types contained in the field codes.
            </summary><remarks><p>Use this method after document changes that affect field types.</p><p>To change field type values in the whole document use <cref><A HREF="Document.html#normalizeFieldTypes()" title="method in class com.aspose.words.Document">Document.normalizeFieldTypes()</A></cref>.</p></remarks>
</DL>
<HR>

<A NAME="replace(java.lang.String,java.lang.String,boolean,boolean)"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>replace</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public int&nbsp;<B>replace</B>(java.lang.String&nbsp;oldValue, java.lang.String&nbsp;newValue, boolean&nbsp;isMatchCase, boolean&nbsp;isMatchWholeWord)
           throws java.lang.Exception</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Replaces all occurrences of a specified string with another string.
            </summary><remarks><p>An exception is thrown if a captured or replacement string contain one
            or more special characters: paragraph break, cell break, section break,
            field start, field separator, field end, inline picture, drawing object, footnote.</p></remarks><DL><DT><B>Parameters:</B></DT><DD param="oldValue"><CODE>oldValue</CODE> - A string to be replaced.</DD><DD param="newValue"><CODE>newValue</CODE> - A string to replace all occurrences of oldValue.</DD><DD param="isMatchCase"><CODE>isMatchCase</CODE> - True indicates case-sensitive comparison, false indicates case-insensitive comparision.</DD><DD param="isMatchWholeWord"><CODE>isMatchWholeWord</CODE> - True indicates the oldValue must be a standalone word.</DD></DL><DL><DT><B>Returns:</B></DT><DD returns="">The number of replacements made.</DD></DL>
</DL>
<HR>

<A NAME="replace(java.lang.String,java.lang.String,com.aspose.words.FindReplaceOptions)"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>replace</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public int&nbsp;<B>replace</B>(java.lang.String&nbsp;pattern, java.lang.String&nbsp;replacement, <A HREF="FindReplaceOptions.html" title="class in com.aspose.words">FindReplaceOptions</A>&nbsp;options)
           throws java.lang.Exception</PRE></TD></TR></TABLE>
<DL><DD><summary>
             Replaces all occurrences of a character pattern specified by a regular expression with another string.
             </summary><remarks><p>Replaces the whole match captured by the regular expression.</p><p>This is an advanced version of replace method and it's able to process breaks in both pattern and replacement strings.</p>
             You should use special meta-characters if you need to work with breaks:
             <ul><li><b>&amp;p</b> - paragraph break</li><li><b>&amp;b</b> - section break</li><li><b>&amp;m</b> - page break</li><li><b>&amp;l</b> - manual line break</li></ul>
             To leave any meta-character intact a parameter <cref><A HREF="FindReplaceOptions.html#PreserveMetaCharacters" title="property in class com.aspose.words.FindReplaceOptions">FindReplaceOptions.PreserveMetaCharacters</A></cref> should be set to true.
             </remarks><DL><DT><B>Parameters:</B></DT><DD param="pattern"><CODE>pattern</CODE> - A string to be replaced.</DD><DD param="replacement"><CODE>replacement</CODE> - A string to replace all occurrences of pattern.</DD><DD param="options"><CODE>options</CODE> - <cref><A HREF="FindReplaceOptions.html" title="class in com.aspose.words">FindReplaceOptions</A></cref> object to specify additional options.</DD></DL><DL><DT><B>Returns:</B></DT><DD returns="">The number of replacements made.</DD></DL><example><p><b>Example:</b></p>Show changes for headers and footers order<pre>
Document doc = new Document(getMyDir() + "HeaderFooter.HeaderFooterOrder.docx");

    //Assert that we use special header and footer for the first page
    //The order for this: first header\footer, even header\footer, primary header\footer
    Section firstPageSection = doc.getFirstSection();
    Assert.assertEquals(firstPageSection.getPageSetup().getDifferentFirstPageHeaderFooter(), true);

    FindReplaceOptions options = new FindReplaceOptions();
    ReplaceLog logger = new ReplaceLog();
    options.setReplacingCallback(logger);

    doc.getRange().replace(Pattern.compile("(header|footer)"), "", options);

    Assert.assertEquals(logger.getText(), "First header\r\nFirst footer\r\nSecond header\r\nSecond footer\r\nThird header\r\n" + "Third footer\r\n");

    //Prepare our string builder for assert results without "DifferentFirstPageHeaderFooter"
    logger.clearText();

    //Remove special first page
    //The order for this: primary header, default header, primary footer, default footer, even header\footer
    firstPageSection.getPageSetup().setDifferentFirstPageHeaderFooter(false);

    doc.getRange().replace(Pattern.compile("(header|footer)"), "", options);
    Assert.assertEquals(logger.getText(), "Third header\r\nFirst header\r\nThird footer\r\nFirst footer\r\nSecond header\r\nSecond footer\r\n");
}

private static class ReplaceLog implements IReplacingCallback
{
    public /*ReplaceAction*/int replacing(ReplacingArgs e)
    {
        _textBuilder.append(e.getMatchNode().getText() + "\r\n");
        return ReplaceAction.SKIP;
    }

    void clearText()
    {
        _textBuilder.setLength(0);
    }

    String getText()
    {
        return _textBuilder.toString();
    }

    private /*final*/ StringBuilder _textBuilder = new StringBuilder();
}</pre></example><example><p><b>Example:</b></p>Shows how to replace text in the document footer.<pre>
// Open the template document, containing obsolete copyright information in the footer.
Document doc = new Document(getMyDir() + "HeaderFooter.ReplaceText.doc");

HeaderFooterCollection headersFooters = doc.getFirstSection().getHeadersFooters();
HeaderFooter footer = headersFooters.getByHeaderFooterType(HeaderFooterType.FOOTER_PRIMARY);

FindReplaceOptions options = new FindReplaceOptions();
options.setMatchCase(false);
options.setFindWholeWordsOnly(false);

footer.getRange().replace("(C) 2006 Aspose Pty Ltd.", "Copyright (C) 2011 by Aspose Pty Ltd.", options);

doc.save(getMyDir() + "\\Artifacts\\HeaderFooter.ReplaceText.doc");</pre></example><example><p><b>Example:</b></p>Shows how to replace all instances of string of text in a table and cell.<pre>
Document doc = new Document(getMyDir() + "Table.SimpleTable.doc");

// Get the first table in the document.
Table table = (Table) doc.getChild(NodeType.TABLE, 0, true);

FindReplaceOptions options = new FindReplaceOptions();
options.setMatchCase(true);
options.setFindWholeWordsOnly(true);

// Replace any instances of our string in the entire table.
table.getRange().replace("Carrots", "Eggs", options);
// Replace any instances of our string in the last cell of the table only.
table.getLastRow().getLastCell().getRange().replace("50", "20", options);

doc.save(getMyDir() + "\\Artifacts\\Table.ReplaceCellText.doc");</pre></example><example><p><b>Example:</b></p>Simple find and replace operation.<pre>
// Open the document.
Document doc = new Document();
DocumentBuilder builder = new DocumentBuilder(doc);

builder.writeln("Hello _CustomerName_,");

// Check the document contains what we are about to test.
System.out.println(doc.getFirstSection().getBody().getParagraphs().get(0).getText());

FindReplaceOptions options = new FindReplaceOptions();
options.setMatchCase(false);
options.setFindWholeWordsOnly(false);

// Replace the text in the document.
doc.getRange().replace("_CustomerName_", "James Bond", options);

// Save the modified document.
doc.save(getMyDir() + "\\Artifacts\\Range.ReplaceSimple.docx");</pre></example><example><p><b>Example:</b></p><pre>
             Document doc = new Document();
             DocumentBuilder builder = new DocumentBuilder(doc);
             builder.Writeln("Numbers 1, 2, 3");
            
             // Inserts paragraph break after Numbers.
             doc.Range.Replace("Numbers", "Numbers&amp;p", new FindReplaceOptions());
             </pre></example>
</DL>
<HR>

<A NAME="replace(java.util.regex.Pattern,com.aspose.words.IReplacingCallback,boolean)"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>replace</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public int&nbsp;<B>replace</B>(java.util.regex.Pattern&nbsp;pattern, <A HREF="IReplacingCallback.html" title="interface in com.aspose.words">IReplacingCallback</A>&nbsp;handler, boolean&nbsp;isForward)
           throws java.lang.Exception</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Finds all occurrences of a character pattern specified by a regular expression and calls a
            user defined replace evaluator method.
            </summary><remarks><p>An exception is thrown if a captured or replacement string contain one
            or more special characters: paragraph break, cell break, section break,
            field start, field separator, field end, inline picture, drawing object, footnote.</p></remarks><DL><DT><B>Parameters:</B></DT><DD param="pattern"><CODE>pattern</CODE> - A regular expression pattern used to find matches.</DD><DD param="handler"><CODE>handler</CODE> - The user-defined method which evaluates replacement at each step.</DD><DD param="isForward"><CODE>isForward</CODE> - True to replace from the beginning of the range to the end.</DD></DL><DL><DT><B>Returns:</B></DT><DD returns="">The number of replacements made.</DD></DL>
</DL>
<HR>

<A NAME="replace(java.util.regex.Pattern,java.lang.String)"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>replace</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public int&nbsp;<B>replace</B>(java.util.regex.Pattern&nbsp;pattern, java.lang.String&nbsp;replacement)
           throws java.lang.Exception</PRE></TD></TR></TABLE>
<DL><DD><summary>
             Replaces all occurrences of a character pattern specified by a regular expression with another string.
             </summary><remarks><p>Replaces the whole match captured by the regular expression.</p><p>An exception is thrown if a captured or replacement string contain one
             or more special characters: paragraph break, cell break, section break,
             field start, field separator, field end, inline picture, drawing object, footnote.</p></remarks><DL><DT><B>Parameters:</B></DT><DD param="pattern"><CODE>pattern</CODE> - A regular expression pattern used to find matches.</DD><DD param="replacement"><CODE>replacement</CODE> - A string to replace all occurrences of oldValue.</DD></DL><DL><DT><B>Returns:</B></DT><DD returns="">The number of replacements made.</DD></DL>
</DL>
<HR>

<A NAME="replace(java.util.regex.Pattern,java.lang.String,com.aspose.words.FindReplaceOptions)"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>replace</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public int&nbsp;<B>replace</B>(java.util.regex.Pattern&nbsp;pattern, java.lang.String&nbsp;replacement, <A HREF="FindReplaceOptions.html" title="class in com.aspose.words">FindReplaceOptions</A>&nbsp;options)
           throws java.lang.Exception</PRE></TD></TR></TABLE>
<DL><DD><summary>
             Replaces all occurrences of a character pattern specified by a regular expression with another string.
             </summary><remarks><p>Replaces the whole match captured by the regular expression.</p><p>This is an advanced version of replace method and it's able to process breaks in both pattern and replacement strings.</p>
             You should use special meta-characters if you need to work with breaks:
             <ul><li><b>&amp;p</b> - paragraph break</li><li><b>&amp;b</b> - section break</li><li><b>&amp;m</b> - page break</li><li><b>&amp;l</b> - manual line break</li></ul>
             To leave any meta-character intact a parameter <cref><A HREF="FindReplaceOptions.html#PreserveMetaCharacters" title="property in class com.aspose.words.FindReplaceOptions">FindReplaceOptions.PreserveMetaCharacters</A></cref> should be set to true.
             </remarks><DL><DT><B>Parameters:</B></DT><DD param="pattern"><CODE>pattern</CODE> - A regular expression pattern used to find matches.</DD><DD param="replacement"><CODE>replacement</CODE> - A string to replace all occurrences of pattern.</DD><DD param="options"><CODE>options</CODE> - <cref><A HREF="FindReplaceOptions.html" title="class in com.aspose.words">FindReplaceOptions</A></cref> object to specify additional options.</DD></DL><DL><DT><B>Returns:</B></DT><DD returns="">The number of replacements made.</DD></DL><example><p><b>Example:</b></p>Replaces text specified with regular expression with HTML.<pre>
public void replaceWithInsertHtml() throws Exception
{
    // Open the document.
    Document doc = new Document();
    DocumentBuilder builder = new DocumentBuilder(doc);

    builder.writeln("Hello &lt;CustomerName&gt;,");

    FindReplaceOptions options = new FindReplaceOptions();
    options.setReplacingCallback(new ReplaceWithHtmlEvaluator(options));

    doc.getRange().replace(Pattern.compile(" &lt;CustomerName&gt;,"), "", options);

    // Save the modified document.
    doc.save(getMyDir() + "\\Artifacts\\Range.ReplaceWithInsertHtml.doc");

}

private class ReplaceWithHtmlEvaluator implements IReplacingCallback
{
    ReplaceWithHtmlEvaluator(FindReplaceOptions options)
    {
        mOptions = options;
    }

    /**
     * NOTE: This is a simplistic method that will only work well when the match
     * starts at the beginning of a run.
     */
    public int replacing(ReplacingArgs e) throws Exception
    {
        DocumentBuilder builder = new DocumentBuilder((Document) e.getMatchNode().getDocument());
        builder.moveTo(e.getMatchNode());

        // Replace '&lt;CustomerName&gt;' text with a red bold name.
        builder.insertHtml("&lt;b&gt;&lt;font color='red'&gt;James Bond, &lt;/font&gt;&lt;/b&gt;");
        e.setReplacement("");

        return ReplaceAction.REPLACE;
    }

    private /*final*/ FindReplaceOptions mOptions;
}</pre></example><example><p><b>Example:</b></p>Shows how to insert content of one document into another during a customized find and replace operation.<pre>
public void insertDocumentAtReplace() throws Exception
{
    Document mainDoc = new Document(getMyDir() + "InsertDocument1.doc");

    FindReplaceOptions options = new FindReplaceOptions();
    options.setDirection(FindReplaceDirection.BACKWARD);
    options.setReplacingCallback(new InsertDocumentAtReplaceHandler());

    mainDoc.getRange().replace(Pattern.compile("\\[MY_DOCUMENT\\]"), "", options);
    mainDoc.save(getMyDir() + "\\Artifacts\\InsertDocumentAtReplace.doc");
}

private class InsertDocumentAtReplaceHandler implements IReplacingCallback
{
    public int replacing(ReplacingArgs e) throws Exception
    {
        Document subDoc = new Document(getMyDir() + "InsertDocument2.doc");

        // Insert a document after the paragraph, containing the match text.
        Paragraph para = (Paragraph) e.getMatchNode().getParentNode();
        insertDocument(para, subDoc);

        // Remove the paragraph with the match text.
        para.remove();

        return ReplaceAction.SKIP;
    }
}</pre></example><example><p><b>Example:</b></p>Shows how to replace all occurrences of words "sad" or "mad" to "bad".<pre>
Document doc = new Document(getMyDir() + "Document.doc");

FindReplaceOptions options = new FindReplaceOptions();
options.setMatchCase(false);
options.setFindWholeWordsOnly(false);

doc.getRange().replace(Pattern.compile("[s|m]ad"), "bad", options);</pre></example><example><p><b>Example:</b></p><pre>
             Document doc = new Document();
             DocumentBuilder builder = new DocumentBuilder(doc);
             builder.Writeln("a1, b2, c3");
            
             // Replaces each number with paragraph break.
             doc.Range.Replace(new Regex(@"\d+"), "&amp;p", new FindReplaceOptions());
             </pre></example>
</DL>
<HR>

<A NAME="toDocument()"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>toDocument</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public <A HREF="Document.html" title="class in com.aspose.words">Document</A>&nbsp;<B>toDocument</B>()
                   throws java.lang.Exception</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Constructs a new fully formed document that contains the range.
            </summary>
</DL>
<HR>

<A NAME="unlinkFields()"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>unlinkFields</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public void&nbsp;<B>unlinkFields</B>()
                 throws java.lang.Exception</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Unlinks fields in this range.
            </summary><remarks><p>Replaces all the fields in this range with their most recent results.</p><p>To unlink fields in the whole document use <cref><i>unlinkFields()</i></cref>.</p></remarks><example><p><b>Example:</b></p>Shows how to unlink all fields in range<pre>
Document doc = new Document(getMyDir() + "Field.UnlinkFields.docx");

Section newSection = doc.getSections().get(0).deepClone();
doc.getSections().add(newSection);

doc.getSections().get(1).getRange().unlinkFields();</pre></example>
</DL>
<HR>

<A NAME="updateFields()"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>updateFields</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public void&nbsp;<B>updateFields</B>()
                 throws java.lang.Exception</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Updates the values of document fields in this range.
            </summary><remarks><p>When you open, modify and then save a document, Aspose.Words does not update fields automatically, it keeps them intact.
Therefore, you would usually want to call this method before saving if you have modified the document
programmatically and want to make sure the proper (calculated) field values appear in the saved document.</p><p>There is no need to update fields after executing a mail merge because mail merge is a kind of field update
and automatically updates all fields in the document.</p><p>This method does not update all field types. For the detailed list of supported field types, see the Programmers Guide.</p><p>This method does not update fields that are related to the page layout algorithms (e.g. PAGE, PAGES, PAGEREF).
The page layout-related fields are updated when you render a document or call <cref><A HREF="Document.html#updatePageLayout()" title="method in class com.aspose.words.Document">Document.updatePageLayout()</A></cref>.</p><p>To update fields in the whole document use <cref><A HREF="Document.html#updateFields()" title="method in class com.aspose.words.Document">Document.updateFields()</A></cref>.</p></remarks><example><p><b>Example:</b></p>Demonstrates how to update document fields in the body of the first section only.<pre>
doc.getFirstSection().getBody().getRange().updateFields();</pre></example>
</DL>
<HR>

<B>See Also:</B>
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A href="http://www.aspose.com/Products/Aspose.Words/Api/index.html" TARGET="_blank">Aspose.Words Documentation</A> - the home page for the Aspose.Words Product Documentation.<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A href="http://www.aspose.com/Community/forums/ShowForum.aspx?ForumID=75" TARGET="_blank">Aspose.Words Support Forum</A> - our preferred method of support.<P>
<div class="footer"><hr><p><a href='http://www.aspose.com/Wiki/default.aspx/Aspose.Corporate/ContactAspose.html'>We guarantee a prompt response to any inquiry!</a></p><p>&copy; 2003-2007 Aspose Pty Ltd. All rights reserved.</p></div></BODY></HTML>