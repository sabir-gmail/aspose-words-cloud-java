<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"
><HTML>
<HEAD>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<!-- Generated by javadoc - compatibility string-->
<!-- Generated by Aspose.JavaDoc 09 Aug 2018 -->
<TITLE>FieldMergingArgsBase</TITLE>
<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../stylesheet.css" TITLE="Style"></HEAD>
<BODY BGCOLOR="white">
<!-- ======== START OF CLASS DATA ======== -->
<H2><a href="package-summary.html"><FONT SIZE="-1">
com.aspose.words
</FONT></a><BR>Class FieldMergingArgsBase</H2>
<PRE>
java.lang.Object
    <IMG SRC="../../../resources/inherit.gif" ALT="extended by "><B>com.aspose.words.FieldMergingArgsBase</B>
</PRE>
<DL>
<DT><B>Direct Known Subclasses:</B> <DD><A HREF="FieldMergingArgs.html" title="class in com.aspose.words">FieldMergingArgs</A>, <A HREF="ImageFieldMergingArgs.html" title="class in com.aspose.words">ImageFieldMergingArgs</A></DD>
</DL>
<HR>
<DL>
<DT><PRE>public abstract class <B>FieldMergingArgsBase </B><DT>extends java.lang.Object</DL>
</PRE>

<P>

<summary>
             Base class for <cref><A HREF="FieldMergingArgs.html" title="class in com.aspose.words">FieldMergingArgs</A></cref> and <cref><A HREF="ImageFieldMergingArgs.html" title="class in com.aspose.words">ImageFieldMergingArgs</A></cref>.
             </summary><remarks></remarks><DL><DT><B>See Also:</B></DT><DD><cref seealso=""><A HREF="FieldMergingArgs.html" title="class in com.aspose.words">FieldMergingArgs</A></cref>, <cref seealso=""><A HREF="ImageFieldMergingArgs.html" title="class in com.aspose.words">ImageFieldMergingArgs</A></cref></DD></DL>
<HR>
<P>

<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<P>

<!-- ========== PROPERTY SUMMARY =========== -->

<A NAME="property_summary"><!-- --></A>
<TABLE RULES="GROUPS" BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<COLGROUP></COLGROUP><COLGROUP SPAN="2"></COLGROUP><THEAD><TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="3"><FONT SIZE="+2">
<B>Property Getters/Setters Summary</B></FONT></TH>
</TR></THEAD>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE><A HREF="Document.html" title="class in com.aspose.words">Document</A></CODE></TD><TD><CODE><B><A HREF="#Document">getDocument</A></B>()</CODE></TD><TD ALIGN="right" ></TD></TR><TR><TD></TD><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Returns the <cref><i>Document</i></cref> object for which the mail merge is performed.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE>java.lang.String</CODE></TD><TD><CODE><B><A HREF="#DocumentFieldName">getDocumentFieldName</A></B>()</CODE></TD><TD ALIGN="right" ></TD></TR><TR><TD></TD><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Gets the name of the merge field as specified in the document.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE><A HREF="FieldMergeField.html" title="class in com.aspose.words">FieldMergeField</A></CODE></TD><TD><CODE><B><A HREF="#Field">getField</A></B>()</CODE></TD><TD ALIGN="right" ></TD></TR><TR><TD></TD><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Gets the object that represents the current merge field.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE>java.lang.String</CODE></TD><TD><CODE><B><A HREF="#FieldName">getFieldName</A></B>()</CODE></TD><TD ALIGN="right" ></TD></TR><TR><TD></TD><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Gets the name of the merge field in the data source.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE>java.lang.Object</CODE></TD><TD><CODE><B><A HREF="#FieldValue">getFieldValue</A></B>()</CODE></TD><TD ALIGN="right" ></TD></TR><TR><TD></TD><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Gets the value of the field from the data source.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE>int</CODE></TD><TD><CODE><B><A HREF="#RecordIndex">getRecordIndex</A></B>()</CODE></TD><TD ALIGN="right" ></TD></TR><TR><TD></TD><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Gets the zero based index of the record that is being merged.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE>java.lang.String</CODE></TD><TD><CODE><B><A HREF="#TableName">getTableName</A></B>()</CODE></TD><TD ALIGN="right" ></TD></TR><TR><TD></TD><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Gets the name of the data table for the current merge operation or empty string if the name is not available.
            </TD>
</TR></TBODY>
</TABLE>&nbsp;<P>

<!-- ============ PROPERTY DETAIL ========== -->

<A NAME="property_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Property Getters/Setters Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="Document"><!-- --></A><A NAME="getDocument()"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>getDocument</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public <A HREF="Document.html" title="class in com.aspose.words">Document</A>&nbsp;<B>getDocument</B>()
</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Returns the <cref><i>Document</i></cref> object for which the mail merge is performed.
            </summary><example><p><b>Example:</b></p>Shows how to mail merge HTML data into a document.<pre>
// File 'MailMerge.InsertHtml.doc' has merge field named 'htmlField1' in it.
// File 'MailMerge.HtmlData.html' contains some valid HTML data.
// The same approach can be used when merging HTML data from database.

public void mailMergeInsertHtml() throws Exception
{
    Document doc = new Document(getMyDir() + "MailMerge.InsertHtml.doc");

    // Add a handler for the MergeField event.
    doc.getMailMerge().setFieldMergingCallback(new HandleMergeFieldInsertHtml());

    // Load some Html from file.
    StringBuilder htmlText = new StringBuilder();
    BufferedReader reader = new BufferedReader(new FileReader(getMyDir() + "MailMerge.HtmlData.html"));
    String line;
    while ((line = reader.readLine()) != null)
    {
        htmlText.append(line);
        htmlText.append("\r\n");
    }

    // Execute mail merge.
    doc.getMailMerge().execute(new String[]{"htmlField1"}, new String[]{htmlText.toString()});

    // Save resulting document with a new name.
    doc.save(getMyDir() + "\\Artifacts\\MailMerge.InsertHtml.doc");
}

private class HandleMergeFieldInsertHtml implements IFieldMergingCallback
{
    /**
     * This is called when merge field is actually merged with data in the document.
     */
    public void fieldMerging(FieldMergingArgs e) throws Exception
    {
        // All merge fields that expect HTML data should be marked with some prefix, e.g. 'html'.
        if (e.getDocumentFieldName().startsWith("html"))
        {
            // Insert the text for this merge field as HTML data, using DocumentBuilder.
            DocumentBuilder builder = new DocumentBuilder(e.getDocument());
            builder.moveToMergeField(e.getDocumentFieldName());
            builder.insertHtml((String) e.getFieldValue());

            // The HTML text itself should not be inserted.
            // We have already inserted it as an HTML.
            e.setText("");
        }
    }

    public void imageFieldMerging(ImageFieldMergingArgs e)
    {
        // Do nothing.
    }
}</pre></example>
</DL>
<HR>

<A NAME="DocumentFieldName"><!-- --></A><A NAME="getDocumentFieldName()"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>getDocumentFieldName</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public java.lang.String&nbsp;<B>getDocumentFieldName</B>()
</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Gets the name of the merge field as specified in the document.
            </summary><remarks><p>If you have a mapping from a document field name to a different data source field name,
            then this is the original field name as specified in the document.</p><p>If you specified a field name prefix, for example "Image:MyFieldName" in the document,
            then <b>DocumentFieldName</b> returns field name without the prefix, that is "MyFieldName".</p></remarks><example><p><b>Example:</b></p>Shows how to mail merge HTML data into a document.<pre>
// File 'MailMerge.InsertHtml.doc' has merge field named 'htmlField1' in it.
// File 'MailMerge.HtmlData.html' contains some valid HTML data.
// The same approach can be used when merging HTML data from database.

public void mailMergeInsertHtml() throws Exception
{
    Document doc = new Document(getMyDir() + "MailMerge.InsertHtml.doc");

    // Add a handler for the MergeField event.
    doc.getMailMerge().setFieldMergingCallback(new HandleMergeFieldInsertHtml());

    // Load some Html from file.
    StringBuilder htmlText = new StringBuilder();
    BufferedReader reader = new BufferedReader(new FileReader(getMyDir() + "MailMerge.HtmlData.html"));
    String line;
    while ((line = reader.readLine()) != null)
    {
        htmlText.append(line);
        htmlText.append("\r\n");
    }

    // Execute mail merge.
    doc.getMailMerge().execute(new String[]{"htmlField1"}, new String[]{htmlText.toString()});

    // Save resulting document with a new name.
    doc.save(getMyDir() + "\\Artifacts\\MailMerge.InsertHtml.doc");
}

private class HandleMergeFieldInsertHtml implements IFieldMergingCallback
{
    /**
     * This is called when merge field is actually merged with data in the document.
     */
    public void fieldMerging(FieldMergingArgs e) throws Exception
    {
        // All merge fields that expect HTML data should be marked with some prefix, e.g. 'html'.
        if (e.getDocumentFieldName().startsWith("html"))
        {
            // Insert the text for this merge field as HTML data, using DocumentBuilder.
            DocumentBuilder builder = new DocumentBuilder(e.getDocument());
            builder.moveToMergeField(e.getDocumentFieldName());
            builder.insertHtml((String) e.getFieldValue());

            // The HTML text itself should not be inserted.
            // We have already inserted it as an HTML.
            e.setText("");
        }
    }

    public void imageFieldMerging(ImageFieldMergingArgs e)
    {
        // Do nothing.
    }
}</pre></example>
</DL>
<HR>

<A NAME="Field"><!-- --></A><A NAME="getField()"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>getField</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public <A HREF="FieldMergeField.html" title="class in com.aspose.words">FieldMergeField</A>&nbsp;<B>getField</B>()
</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Gets the object that represents the current merge field.
            </summary>
</DL>
<HR>

<A NAME="FieldName"><!-- --></A><A NAME="getFieldName()"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>getFieldName</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public java.lang.String&nbsp;<B>getFieldName</B>()
</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Gets the name of the merge field in the data source.
            </summary><remarks><p>If you have a mapping from a document field name to a different data source field name,
            then this is the mapped field name.</p><p>If you specified a field name prefix, for example "Image:MyFieldName" in the document,
            then <b>FieldName</b> returns field name without the prefix, that is "MyFieldName".</p></remarks><example><p><b>Example:</b></p>Shows how to insert checkbox form fields into a document during mail merge.<pre>
// File 'MailMerge.InsertCheckBox.doc' is a template
// containing the table with the following fields in it:
// &lt;&lt;TableStart:StudentCourse&gt;&gt; &lt;&lt;CourseName&gt;&gt; &lt;&lt;TableEnd:StudentCourse&gt;&gt;.

public void mailMergeInsertCheckBox() throws Exception
{
    Document doc = new Document(getMyDir() + "MailMerge.InsertCheckBox.doc");

    // Add a handler for the MergeField event.
    doc.getMailMerge().setFieldMergingCallback(new HandleMergeFieldInsertCheckBox());

    // Execute mail merge with regions.
    DataTable dataTable = getStudentCourseDataTable();
    doc.getMailMerge().executeWithRegions(dataTable);

    // Save resulting document with a new name.
    doc.save(getMyDir() + "\\Artifacts\\MailMerge.InsertCheckBox.doc");
}

private class HandleMergeFieldInsertCheckBox implements IFieldMergingCallback
{
    /**
     * This is called for each merge field in the document
     * when Document.MailMerge.ExecuteWithRegions is called.
     */
    public void fieldMerging(FieldMergingArgs e) throws Exception
    {
        if (e.getDocumentFieldName().equals("CourseName"))
        {
            // Insert the checkbox for this merge field, using DocumentBuilder.
            DocumentBuilder builder = new DocumentBuilder(e.getDocument());
            builder.moveToMergeField(e.getFieldName());
            builder.insertCheckBox(e.getDocumentFieldName() + Integer.toString(mCheckBoxCount), false, 0);
            builder.write((String) e.getFieldValue());
            mCheckBoxCount++;
        }
    }

    public void imageFieldMerging(ImageFieldMergingArgs args)
    {
        // Do nothing.
    }

    /**
     * Counter for CheckBox name generation
     */
    private int mCheckBoxCount;
}

/**
 * Create DataTable and fill it with data.
 * In real life this DataTable should be filled from a database.
 */
private static DataTable getStudentCourseDataTable() throws Exception
{
    DataTable dataTable = new DataTable("StudentCourse");
    dataTable.getColumns().add("CourseName");
    for (int i = 0; i &lt; 10; i++)
    {
        DataRow datarow = dataTable.newRow();
        dataTable.getRows().add(datarow);
        datarow.set(0, "Course " + Integer.toString(i));
    }
    return dataTable;
}</pre></example>
</DL>
<HR>

<A NAME="FieldValue"><!-- --></A><A NAME="getFieldValue()"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>getFieldValue</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public java.lang.Object&nbsp;<B>getFieldValue</B>()
</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Gets the value of the field from the data source.
            </summary><remarks>
            This property contains a value that has just been selected from your data source
            for this field by the mail merge engine.
            </remarks><example><p><b>Example:</b></p>Shows how to mail merge HTML data into a document.<pre>
// File 'MailMerge.InsertHtml.doc' has merge field named 'htmlField1' in it.
// File 'MailMerge.HtmlData.html' contains some valid HTML data.
// The same approach can be used when merging HTML data from database.

public void mailMergeInsertHtml() throws Exception
{
    Document doc = new Document(getMyDir() + "MailMerge.InsertHtml.doc");

    // Add a handler for the MergeField event.
    doc.getMailMerge().setFieldMergingCallback(new HandleMergeFieldInsertHtml());

    // Load some Html from file.
    StringBuilder htmlText = new StringBuilder();
    BufferedReader reader = new BufferedReader(new FileReader(getMyDir() + "MailMerge.HtmlData.html"));
    String line;
    while ((line = reader.readLine()) != null)
    {
        htmlText.append(line);
        htmlText.append("\r\n");
    }

    // Execute mail merge.
    doc.getMailMerge().execute(new String[]{"htmlField1"}, new String[]{htmlText.toString()});

    // Save resulting document with a new name.
    doc.save(getMyDir() + "\\Artifacts\\MailMerge.InsertHtml.doc");
}

private class HandleMergeFieldInsertHtml implements IFieldMergingCallback
{
    /**
     * This is called when merge field is actually merged with data in the document.
     */
    public void fieldMerging(FieldMergingArgs e) throws Exception
    {
        // All merge fields that expect HTML data should be marked with some prefix, e.g. 'html'.
        if (e.getDocumentFieldName().startsWith("html"))
        {
            // Insert the text for this merge field as HTML data, using DocumentBuilder.
            DocumentBuilder builder = new DocumentBuilder(e.getDocument());
            builder.moveToMergeField(e.getDocumentFieldName());
            builder.insertHtml((String) e.getFieldValue());

            // The HTML text itself should not be inserted.
            // We have already inserted it as an HTML.
            e.setText("");
        }
    }

    public void imageFieldMerging(ImageFieldMergingArgs e)
    {
        // Do nothing.
    }
}</pre></example>
</DL>
<HR>

<A NAME="RecordIndex"><!-- --></A><A NAME="getRecordIndex()"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>getRecordIndex</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public int&nbsp;<B>getRecordIndex</B>()
</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Gets the zero based index of the record that is being merged.
            </summary>
</DL>
<HR>

<A NAME="TableName"><!-- --></A><A NAME="getTableName()"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>getTableName</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public java.lang.String&nbsp;<B>getTableName</B>()
</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Gets the name of the data table for the current merge operation or empty string if the name is not available.
            </summary><example><p><b>Example:</b></p>Shows how to define custom logic in a handler implementing IFieldMergingCallback that is executed for unmerged regions in the document.<pre>
public static class EmptyRegionsHandler implements IFieldMergingCallback
{
    /**
     * Called for each field belonging to an unmerged region in the document.
     */
    public void fieldMerging(FieldMergingArgs args) throws Exception
    {
        // Change the text of each field of the ContactDetails region individually.
        if ("ContactDetails".equals(args.getTableName()))
        {
            // Set the text of the field based off the field name.
            if ("Name".equals(args.getFieldName()))
                args.setText("(No details found)");
            else if ("Number".equals(args.getFieldName()))
                args.setText("(N/A)");
        }

        // Remove the entire table of the Suppliers region. Also check if the previous paragraph
        // before the table is a heading paragraph and if so remove that too.
        if ("Suppliers".equals(args.getTableName()))
        {
            Table table = (Table)args.getField().getStart().getAncestor(NodeType.TABLE);

            // Check if the table has been removed from the document already.
            if (table.getParentNode() != null)
            {
                // Try to find the paragraph which precedes the table before the table is removed from the document.
                if (table.getPreviousSibling() != null &amp;&amp; table.getPreviousSibling().getNodeType() == NodeType.PARAGRAPH)
                {
                    Paragraph previousPara = (Paragraph)table.getPreviousSibling();
                    if (isHeadingParagraph(previousPara))
                        previousPara.remove();
                }

                table.remove();
            }
        }
    }

    /**
     * Returns true if the paragraph uses any Heading style e.g Heading 1 to Heading 9
     */
    private boolean isHeadingParagraph(Paragraph para) throws Exception
    {
        return (para.getParagraphFormat().getStyleIdentifier() &gt;= StyleIdentifier.HEADING_1 &amp;&amp; para.getParagraphFormat().getStyleIdentifier() &lt;= StyleIdentifier.HEADING_9);
    }

    public void imageFieldMerging(ImageFieldMergingArgs args) throws Exception
    {
        // Do Nothing
    }
}</pre></example>
</DL>
<HR>

<B>See Also:</B>
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A href="http://www.aspose.com/Products/Aspose.Words/Api/index.html" TARGET="_blank">Aspose.Words Documentation</A> - the home page for the Aspose.Words Product Documentation.<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A href="http://www.aspose.com/Community/forums/ShowForum.aspx?ForumID=75" TARGET="_blank">Aspose.Words Support Forum</A> - our preferred method of support.<P>
<div class="footer"><hr><p><a href='http://www.aspose.com/Wiki/default.aspx/Aspose.Corporate/ContactAspose.html'>We guarantee a prompt response to any inquiry!</a></p><p>&copy; 2003-2007 Aspose Pty Ltd. All rights reserved.</p></div></BODY></HTML>