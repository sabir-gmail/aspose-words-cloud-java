<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"
><HTML>
<HEAD>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<!-- Generated by javadoc - compatibility string-->
<!-- Generated by Aspose.JavaDoc 09 Aug 2018 -->
<TITLE>IFieldMergingCallback</TITLE>
<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../stylesheet.css" TITLE="Style"></HEAD>
<BODY BGCOLOR="white">
<!-- ======== START OF CLASS DATA ======== -->
<H2><a href="package-summary.html"><FONT SIZE="-1">
com.aspose.words
</FONT></a><BR>Interface IFieldMergingCallback</H2>
<HR>
<DL>
<DT><PRE>public interface <B>IFieldMergingCallback </B></DL>
</PRE>

<P>

<summary>
            Implement this interface if you want to control how data is inserted into merge fields during a mail merge operation.
            </summary><example><p><b>Example:</b></p>Shows how to insert images stored in a database BLOB field into a report.<pre>
public void mailMergeImageFromBlob() throws Exception
{
    Document doc = new Document(getMyDir() + "MailMerge.MergeImage.doc");

    // Set up the event handler for image fields.
    doc.getMailMerge().setFieldMergingCallback(new HandleMergeImageFieldFromBlob());

    Class.forName("net.ucanaccess.jdbc.UcanaccessDriver"); // Loads the driver

    // Open the database connection.
    String connString = "jdbc:ucanaccess://" + getDatabaseDir() + "Northwind.mdb";

    // DSN-less DB connection.
    java.sql.Connection conn = java.sql.DriverManager.getConnection(connString, "Admin", "");

    // Create and execute a command.
    java.sql.Statement statement = conn.createStatement();
    java.sql.ResultSet resultSet = statement.executeQuery("SELECT * FROM Employees");

    DataTable table = new DataTable(resultSet, "Employees");

    // Perform mail merge.
    doc.getMailMerge().executeWithRegions(table);

    // Close the database.
    conn.close();

    doc.save(getMyDir() + "\\Artifacts\\MailMerge.MergeImage.doc");
}

private class HandleMergeImageFieldFromBlob implements IFieldMergingCallback
{
    public void fieldMerging(FieldMergingArgs args)
    {
        // Do nothing.
    }

    /**
     * This is called when mail merge engine encounters Image:XXX merge field in the document.
     * You have a chance to return an Image object, file name or a stream that contains the image.
     */
    public void imageFieldMerging(ImageFieldMergingArgs e)
    {
        // The field value is a byte array, just cast it and create a stream on it.
        ByteArrayInputStream imageStream = new ByteArrayInputStream((byte[]) e.getFieldValue());
        // Now the mail merge engine will retrieve the image from the stream.
        e.setImageStream(imageStream);
    }
}</pre></example><example><p><b>Example:</b></p>Shows how to mail merge HTML data into a document.<pre>
// File 'MailMerge.InsertHtml.doc' has merge field named 'htmlField1' in it.
// File 'MailMerge.HtmlData.html' contains some valid HTML data.
// The same approach can be used when merging HTML data from database.

public void mailMergeInsertHtml() throws Exception
{
    Document doc = new Document(getMyDir() + "MailMerge.InsertHtml.doc");

    // Add a handler for the MergeField event.
    doc.getMailMerge().setFieldMergingCallback(new HandleMergeFieldInsertHtml());

    // Load some Html from file.
    StringBuilder htmlText = new StringBuilder();
    BufferedReader reader = new BufferedReader(new FileReader(getMyDir() + "MailMerge.HtmlData.html"));
    String line;
    while ((line = reader.readLine()) != null)
    {
        htmlText.append(line);
        htmlText.append("\r\n");
    }

    // Execute mail merge.
    doc.getMailMerge().execute(new String[]{"htmlField1"}, new String[]{htmlText.toString()});

    // Save resulting document with a new name.
    doc.save(getMyDir() + "\\Artifacts\\MailMerge.InsertHtml.doc");
}

private class HandleMergeFieldInsertHtml implements IFieldMergingCallback
{
    /**
     * This is called when merge field is actually merged with data in the document.
     */
    public void fieldMerging(FieldMergingArgs e) throws Exception
    {
        // All merge fields that expect HTML data should be marked with some prefix, e.g. 'html'.
        if (e.getDocumentFieldName().startsWith("html"))
        {
            // Insert the text for this merge field as HTML data, using DocumentBuilder.
            DocumentBuilder builder = new DocumentBuilder(e.getDocument());
            builder.moveToMergeField(e.getDocumentFieldName());
            builder.insertHtml((String) e.getFieldValue());

            // The HTML text itself should not be inserted.
            // We have already inserted it as an HTML.
            e.setText("");
        }
    }

    public void imageFieldMerging(ImageFieldMergingArgs e)
    {
        // Do nothing.
    }
}</pre></example>
<HR>
<P>

<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<P>

<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" RULES="GROUPS" FRAME="BOX" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<COLGROUP></COLGROUP><COLGROUP SPAN="2"></COLGROUP><THEAD><TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="3"><FONT SIZE="+2">
<B>Method Summary</B></FONT></TH>
</TR></THEAD>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ROWSPAN="2" ALIGN="right" VALIGN="top" WIDTH="1%">
<CODE>abstract&nbsp;void</CODE></TD><TD><CODE><B><A HREF="#fieldMerging(com.aspose.words.FieldMergingArgs)">fieldMerging</A></B>(<A HREF="FieldMergingArgs.html" title="class in com.aspose.words">FieldMergingArgs</A>&nbsp;args)</CODE></TD><TD ALIGN="right" ></TD>
</TR><TR><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Called when the Aspose.Words mail merge engine is about to insert data into a merge field in the document.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ROWSPAN="2" ALIGN="right" VALIGN="top" WIDTH="1%">
<CODE>abstract&nbsp;void</CODE></TD><TD><CODE><B><A HREF="#imageFieldMerging(com.aspose.words.ImageFieldMergingArgs)">imageFieldMerging</A></B>(<A HREF="ImageFieldMergingArgs.html" title="class in com.aspose.words">ImageFieldMergingArgs</A>&nbsp;args)</CODE></TD><TD ALIGN="right" ></TD>
</TR><TR><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Called when the Aspose.Words mail merge engine is about to insert an image into a merge field.
            </TD>
</TR></TBODY>
</TABLE>&nbsp;<P>

<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Method Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="fieldMerging(com.aspose.words.FieldMergingArgs)"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>fieldMerging</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public abstract&nbsp;void&nbsp;<B>fieldMerging</B>(<A HREF="FieldMergingArgs.html" title="class in com.aspose.words">FieldMergingArgs</A>&nbsp;args)
                               throws java.lang.Exception</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Called when the Aspose.Words mail merge engine is about to insert data into a merge field in the document.
            </summary><example><p><b>Example:</b></p>Shows how to mail merge HTML data into a document.<pre>
// File 'MailMerge.InsertHtml.doc' has merge field named 'htmlField1' in it.
// File 'MailMerge.HtmlData.html' contains some valid HTML data.
// The same approach can be used when merging HTML data from database.

public void mailMergeInsertHtml() throws Exception
{
    Document doc = new Document(getMyDir() + "MailMerge.InsertHtml.doc");

    // Add a handler for the MergeField event.
    doc.getMailMerge().setFieldMergingCallback(new HandleMergeFieldInsertHtml());

    // Load some Html from file.
    StringBuilder htmlText = new StringBuilder();
    BufferedReader reader = new BufferedReader(new FileReader(getMyDir() + "MailMerge.HtmlData.html"));
    String line;
    while ((line = reader.readLine()) != null)
    {
        htmlText.append(line);
        htmlText.append("\r\n");
    }

    // Execute mail merge.
    doc.getMailMerge().execute(new String[]{"htmlField1"}, new String[]{htmlText.toString()});

    // Save resulting document with a new name.
    doc.save(getMyDir() + "\\Artifacts\\MailMerge.InsertHtml.doc");
}

private class HandleMergeFieldInsertHtml implements IFieldMergingCallback
{
    /**
     * This is called when merge field is actually merged with data in the document.
     */
    public void fieldMerging(FieldMergingArgs e) throws Exception
    {
        // All merge fields that expect HTML data should be marked with some prefix, e.g. 'html'.
        if (e.getDocumentFieldName().startsWith("html"))
        {
            // Insert the text for this merge field as HTML data, using DocumentBuilder.
            DocumentBuilder builder = new DocumentBuilder(e.getDocument());
            builder.moveToMergeField(e.getDocumentFieldName());
            builder.insertHtml((String) e.getFieldValue());

            // The HTML text itself should not be inserted.
            // We have already inserted it as an HTML.
            e.setText("");
        }
    }

    public void imageFieldMerging(ImageFieldMergingArgs e)
    {
        // Do nothing.
    }
}</pre></example><example><p><b>Example:</b></p>Shows how to insert images stored in a database BLOB field into a report.<pre>
public void mailMergeImageFromBlob() throws Exception
{
    Document doc = new Document(getMyDir() + "MailMerge.MergeImage.doc");

    // Set up the event handler for image fields.
    doc.getMailMerge().setFieldMergingCallback(new HandleMergeImageFieldFromBlob());

    Class.forName("net.ucanaccess.jdbc.UcanaccessDriver"); // Loads the driver

    // Open the database connection.
    String connString = "jdbc:ucanaccess://" + getDatabaseDir() + "Northwind.mdb";

    // DSN-less DB connection.
    java.sql.Connection conn = java.sql.DriverManager.getConnection(connString, "Admin", "");

    // Create and execute a command.
    java.sql.Statement statement = conn.createStatement();
    java.sql.ResultSet resultSet = statement.executeQuery("SELECT * FROM Employees");

    DataTable table = new DataTable(resultSet, "Employees");

    // Perform mail merge.
    doc.getMailMerge().executeWithRegions(table);

    // Close the database.
    conn.close();

    doc.save(getMyDir() + "\\Artifacts\\MailMerge.MergeImage.doc");
}

private class HandleMergeImageFieldFromBlob implements IFieldMergingCallback
{
    public void fieldMerging(FieldMergingArgs args)
    {
        // Do nothing.
    }

    /**
     * This is called when mail merge engine encounters Image:XXX merge field in the document.
     * You have a chance to return an Image object, file name or a stream that contains the image.
     */
    public void imageFieldMerging(ImageFieldMergingArgs e)
    {
        // The field value is a byte array, just cast it and create a stream on it.
        ByteArrayInputStream imageStream = new ByteArrayInputStream((byte[]) e.getFieldValue());
        // Now the mail merge engine will retrieve the image from the stream.
        e.setImageStream(imageStream);
    }
}</pre></example>
</DL>
<HR>

<A NAME="imageFieldMerging(com.aspose.words.ImageFieldMergingArgs)"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>imageFieldMerging</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public abstract&nbsp;void&nbsp;<B>imageFieldMerging</B>(<A HREF="ImageFieldMergingArgs.html" title="class in com.aspose.words">ImageFieldMergingArgs</A>&nbsp;args)
                                    throws java.lang.Exception</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Called when the Aspose.Words mail merge engine is about to insert an image into a merge field.
            </summary><example><p><b>Example:</b></p>Shows how to insert images stored in a database BLOB field into a report.<pre>
public void mailMergeImageFromBlob() throws Exception
{
    Document doc = new Document(getMyDir() + "MailMerge.MergeImage.doc");

    // Set up the event handler for image fields.
    doc.getMailMerge().setFieldMergingCallback(new HandleMergeImageFieldFromBlob());

    Class.forName("net.ucanaccess.jdbc.UcanaccessDriver"); // Loads the driver

    // Open the database connection.
    String connString = "jdbc:ucanaccess://" + getDatabaseDir() + "Northwind.mdb";

    // DSN-less DB connection.
    java.sql.Connection conn = java.sql.DriverManager.getConnection(connString, "Admin", "");

    // Create and execute a command.
    java.sql.Statement statement = conn.createStatement();
    java.sql.ResultSet resultSet = statement.executeQuery("SELECT * FROM Employees");

    DataTable table = new DataTable(resultSet, "Employees");

    // Perform mail merge.
    doc.getMailMerge().executeWithRegions(table);

    // Close the database.
    conn.close();

    doc.save(getMyDir() + "\\Artifacts\\MailMerge.MergeImage.doc");
}

private class HandleMergeImageFieldFromBlob implements IFieldMergingCallback
{
    public void fieldMerging(FieldMergingArgs args)
    {
        // Do nothing.
    }

    /**
     * This is called when mail merge engine encounters Image:XXX merge field in the document.
     * You have a chance to return an Image object, file name or a stream that contains the image.
     */
    public void imageFieldMerging(ImageFieldMergingArgs e)
    {
        // The field value is a byte array, just cast it and create a stream on it.
        ByteArrayInputStream imageStream = new ByteArrayInputStream((byte[]) e.getFieldValue());
        // Now the mail merge engine will retrieve the image from the stream.
        e.setImageStream(imageStream);
    }
}</pre></example>
</DL>
<HR>

<B>See Also:</B>
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A href="http://www.aspose.com/Products/Aspose.Words/Api/index.html" TARGET="_blank">Aspose.Words Documentation</A> - the home page for the Aspose.Words Product Documentation.<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A href="http://www.aspose.com/Community/forums/ShowForum.aspx?ForumID=75" TARGET="_blank">Aspose.Words Support Forum</A> - our preferred method of support.<P>
<div class="footer"><hr><p><a href='http://www.aspose.com/Wiki/default.aspx/Aspose.Corporate/ContactAspose.html'>We guarantee a prompt response to any inquiry!</a></p><p>&copy; 2003-2007 Aspose Pty Ltd. All rights reserved.</p></div></BODY></HTML>